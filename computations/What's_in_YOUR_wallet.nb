(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    195245,       6276]
NotebookOptionsPosition[    179361,       5746]
NotebookOutlinePosition[    179761,       5764]
CellTagsIndexPosition[    179718,       5761]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["What\[CloseCurlyQuote]s in YOUR wallet?", "Title"],

Cell["computation notebook", "Subtitle"],

Cell[TextData[{
 "Eric Rowland\n",
 ButtonBox["http://people.hofstra.edu/Eric_Rowland/papers.html#What's_in_YOUR_\
wallet",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://people.hofstra.edu/Eric_Rowland/papers.html#What's_in_YOUR_\
wallet"], None}]
}], "Subsubtitle"],

Cell[CellGroupData[{

Cell["Introduction", "Section"],

Cell["\<\
This notebook contains the computations performed in the paper \
\[OpenCurlyDoubleQuote]What\[CloseCurlyQuote]s in YOUR wallet?\
\[CloseCurlyDoubleQuote] by Lara Pudwell and Eric Rowland.\
\>", "Text"],

Cell["\<\
To re-run the computations, first you will need to load the PocketChange \
package.  You can load it directly from the web by evaluating the following \
cell.\
\>", "Text"],

Cell[BoxData[
 RowBox[{"Import", "[", 
  "\"\<http://people.hofstra.edu/Eric_Rowland/packages/PocketChange.m\>\"", 
  "]"}]], "Input"],

Cell[TextData[{
 "You can also download it from ",
 ButtonBox["http://people.hofstra.edu/Eric_Rowland/packages.html#PocketChange",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://people.hofstra.edu/Eric_Rowland/packages.html#PocketChange"], 
    None},
  ButtonNote->
   "http://people.hofstra.edu/Eric_Rowland/packages.html#PocketChange"],
 " and then evaluate the following.  (If you need help, see ",
 ButtonBox["loading a package",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["http://people.hofstra.edu/Eric_Rowland/packages/loading_a_package.\
html"], None},
  ButtonNote->
   "http://people.hofstra.edu/Eric_Rowland/packages/loading_a_package.html"],
 ".)"
}], "Text"],

Cell[BoxData[
 RowBox[{"<<", "PocketChange`"}]], "Input"],

Cell["\<\
To check that it loaded correctly, re-evaluate the following.\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"GreedyPartition", "[", 
  RowBox[{"30", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "10", ",", "25"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25", ",", "5"}], "}"}]], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Computing limiting distributions", "Section"],

Cell[CellGroupData[{

Cell["The coin keeper", "Subsection"],

Cell[CellGroupData[{

Cell["U.S. four-denomination currency", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reverse", "[", 
  RowBox[{"Sort", "[", 
   RowBox[{"Tally", "[", 
    RowBox[{"Join", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"GreedyPartition", "[", "n", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "99"}], "}"}]}], "]"}]}], "]"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"25", ",", "150"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "80"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "40"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "200"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 FractionBox[
  RowBox[{"Last", "/@", "%"}], 
  RowBox[{"Total", "[", 
   RowBox[{"Last", "/@", "%"}], "]"}]], "\n", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["15", "47"], ",", 
   FractionBox["8", "47"], ",", 
   FractionBox["4", "47"], ",", 
   FractionBox["20", "47"]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.3191489361702128`", ",", "0.1702127659574468`", ",", 
   "0.0851063829787234`", ",", "0.425531914893617`"}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Distance in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "4"], TraditionalForm]]],
 " from the 2014 U.S. mint production ratios:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EuclideanDistance", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{".319", ",", ".170", ",", ".085", ",", ".426"}], "}"}], ",", 
   RowBox[{"Normalize", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"568", ",", "1676", ",", "1024", ",", "6015"}], "}"}], ",", 
     "Total"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0.34129880014836705`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["U.S. currency including the half dollar", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Reverse", "[", 
  RowBox[{"Sort", "[", 
   RowBox[{"Tally", "[", 
    RowBox[{"Join", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"GreedyPartition", "[", 
        RowBox[{"n", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "5", ",", "10", ",", "25", ",", "50"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "99"}], "}"}]}], "]"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 FractionBox[
  RowBox[{"Last", "/@", "%"}], 
  RowBox[{"Total", "[", 
   RowBox[{"Last", "/@", "%"}], "]"}]], "\n", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"50", ",", "50"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "50"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "80"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "40"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "200"}], "}"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["5", "42"], ",", 
   FractionBox["5", "42"], ",", 
   FractionBox["4", "21"], ",", 
   FractionBox["2", "21"], ",", 
   FractionBox["10", "21"]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.11904761904761904`", ",", "0.11904761904761904`", ",", 
   "0.19047619047619047`", ",", "0.09523809523809523`", ",", 
   "0.47619047619047616`"}], "}"}]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Eurozone six-denomination currency", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Reverse", "[", 
  RowBox[{"Sort", "[", 
   RowBox[{"Tally", "[", 
    RowBox[{"Join", "@@", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"GreedyPartition", "[", 
        RowBox[{"n", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "5", ",", "10", ",", "20", ",", "50"}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", "99"}], "}"}]}], "]"}]}], "]"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 FractionBox[
  RowBox[{"Last", "/@", "%"}], 
  RowBox[{"Total", "[", 
   RowBox[{"Last", "/@", "%"}], "]"}]], "\n", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"50", ",", "50"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "80"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "40"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "50"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "80"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "40"}], "}"}]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["5", "34"], ",", 
   FractionBox["4", "17"], ",", 
   FractionBox["2", "17"], ",", 
   FractionBox["5", "34"], ",", 
   FractionBox["4", "17"], ",", 
   FractionBox["2", "17"]}], "}"}]], "Output"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.14705882352941177`", ",", "0.23529411764705882`", ",", 
   "0.11764705882352941`", ",", "0.14705882352941177`", ",", 
   "0.23529411764705882`", ",", "0.11764705882352941`"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "0.14705882352941177`", ",", "0.23529411764705882`", ",", 
      "0.11764705882352941`", ",", "0.14705882352941177`", ",", 
      "0.23529411764705882`", ",", "0.11764705882352941`"}], "}"}], ",", 
    "3"}], "]"}], "//", "Total"}]], "Input"],

Cell[BoxData["0.5`"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The minimalist spender", "Subsection"],

Cell[CellGroupData[{

Cell["U.S. four-denomination currency", "Subsubsection"],

Cell["Expected number of coins:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Mean", "[", 
  RowBox[{"Length", "/@", 
   RowBox[{"GreedyPartition", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "99"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 FractionBox["47", "10"]], "Output"],

Cell[BoxData["4.7`"], "Output"]
}, Open  ]],

Cell["Expected total value:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Mean", "[", 
  RowBox[{"Total", "/@", 
   RowBox[{"GreedyPartition", "/@", 
    RowBox[{"Range", "[", 
     RowBox[{"0", ",", "99"}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 FractionBox["99", "2"]], "Output"],

Cell[BoxData["49.5`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Shallit currency", "Subsubsection"],

Cell["Make a change table:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"changerules", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", "=", "0"}], "}"}], ",", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerPartitions", "[", 
           RowBox[{"n", ",", 
            RowBox[{"{", "k", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}]}], "]"}], 
          "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"k", "++"}]}], "]"}], ";", 
       RowBox[{"n", "\[Rule]", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", "k", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}]}], 
         "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "99"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "1", "}"}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "5", "}"}], "}"}]}], ",", 
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"7", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"8", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"9", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"10", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"11", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"12", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"13", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"14", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"15", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"16", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"17", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"18", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "18", "}"}], "}"}]}], ",", 
   RowBox[{"19", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"20", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"21", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"22", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"23", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"24", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"25", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "25", "}"}], "}"}]}], ",", 
   RowBox[{"26", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"27", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"28", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"29", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"30", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"31", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"32", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"33", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"34", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"35", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"36", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"37", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"38", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"39", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"40", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"41", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"42", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"43", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"44", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"45", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"46", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"47", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"48", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"49", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"50", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25"}], "}"}], "}"}]}], ",", 
   RowBox[{"51", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"52", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"53", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"54", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"55", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"56", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"57", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"58", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"59", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"60", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"61", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"62", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"63", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "1", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"64", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"65", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"66", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"67", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "5", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"68", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"69", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"70", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "1", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"71", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"72", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"73", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"74", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"75", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25"}], "}"}], "}"}]}], ",", 
   RowBox[{"76", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"77", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"78", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"79", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"80", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"81", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"82", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5", ",", "5"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"83", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"84", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"85", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"86", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"87", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"88", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "1", ",", "1"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"89", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18", ",", "5", ",", "5"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"90", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "18"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"91", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"92", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "5", ",", "1"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"93", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"94", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"95", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "5"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"96", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "5", ",", "5"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"97", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18", ",", "18"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"98", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"99", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "5", ",", "1"}], 
      "}"}], "}"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["Expected number of coins:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Mean", "[", 
  RowBox[{"Length", "/@", 
   RowBox[{"First", "/@", 
    RowBox[{"Last", "/@", "changerules"}]}]}], "]"}], "\n", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 FractionBox["389", "100"]], "Output"],

Cell[BoxData["3.89`"], "Output"]
}, Open  ]],

Cell["Expected total value:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Mean", "[", 
  RowBox[{"Total", "/@", 
   RowBox[{"First", "/@", 
    RowBox[{"Last", "/@", "changerules"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 FractionBox["99", "2"]], "Output"],

Cell[BoxData["49.5`"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The big spender", "Subsection"],

Cell[CellGroupData[{

Cell["A toy example", "Subsubsection"],

Cell["State space:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PartitionList", "[", 
  RowBox[{"{", 
   RowBox[{"25", ",", "50"}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "25", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "25", ",", "25"}], "}"}], ",", 
   RowBox[{"{", "50", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "25"}], "}"}]}], "}"}]], "Output"]
}, Open  ]],

Cell["The paper uses this ordering instead:", "Text"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"{", "25", "}"}], ",", 
   RowBox[{"{", "50", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "50"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "25", ",", "25"}], "}"}]}], "}"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"toyMatrix", "=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"stateset", "=", 
       RowBox[{"Reverse", "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "25", "}"}], ",", 
          RowBox[{"{", "50", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"25", ",", "25"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"25", ",", "50"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"25", ",", "25", ",", "25"}], "}"}]}], "}"}]}]}], ",", 
      RowBox[{"prices", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", "75", ",", "25"}], "]"}]}], ",", 
      RowBox[{"currency", "=", 
       RowBox[{"{", 
        RowBox[{"25", ",", "50"}], "}"}]}]}], "}"}], ",", 
    RowBox[{"SparseArray", "[", 
     RowBox[{"Join", "@@", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"First", "[", "#1", "]"}]}], "}"}], "\[Rule]", 
            FractionBox[
             RowBox[{"Last", "[", "#1", "]"}], 
             RowBox[{"Length", "[", "prices", "]"}]]}], "&"}], ")"}], "/@", 
         RowBox[{"Tally", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"stateset", ",", 
               RowBox[{"BigSpenderTransaction", "[", 
                RowBox[{
                 RowBox[{
                 "stateset", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", "price", ",", "currency"}], 
                "]"}]}], "]"}], "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"price", ",", "prices"}], "}"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "stateset", "]"}]}], "}"}]}], "]"}]}], 
     "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["SparseArray", "SummaryHead"], "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgg2IQe2e3gevOLS/sb7gvX1cz7a39yYjcf/Ff39vjErcq
3x03S+mc/RzjRVvMf1yxf7FI8XHgqldUU08t8YFy52j4UNfegQo3aoUPAIhT
6xM=
                "], {{0, 0}, {6, 6}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["24", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"6", ",", "6"}], "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}]], 
              GraphicsBox[
               RasterBox[CompressedData["
1:eJxTTMoPSmVmYGBgg2IQe2e3gevOLS/sb7gvX1cz7a39yYjcf/Ff39vjErcq
3x03S+mc/RzjRVvMf1yxf7FI8XHgqldUU08t8YFy52j4UNfegQo3aoUPAIhT
6xM=
                "], {{0, 0}, {6, 6}}, {0, 1}], AspectRatio -> 1, Axes -> 
               False, Frame -> False, FrameLabel -> {None, None}, FrameStyle -> 
               Directive[
                 Opacity[0.5], 
                 Thickness[Tiny], 
                 RGBColor[0.368417, 0.506779, 0.709798]], 
               FrameTicks -> {{None, None}, {None, None}}, GridLinesStyle -> 
               Directive[
                 GrayLevel[0.5, 0.4]], ImageSize -> 
               Dynamic[{
                 Automatic, 
                  3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])}], 
               Method -> {
                "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> 
                 Automatic, "DefaultPlotStyle" -> Automatic, "DomainPadding" -> 
                 Scaled[0.02], "RangePadding" -> Scaled[0.05]}], 
              GridBox[{{
                 RowBox[{
                   TagBox[
                   "\"Specified elements: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["24", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Dimensions: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"6", ",", "6"}], "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Default: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Density: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["0.6666666666666666`", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Elements:\"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"\"", "SummaryItem"]}]}, {
                 TagBox[
                  TagBox[
                   GridBox[{{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "4"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "5"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "4"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "3"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "4"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"1", ",", "2"}], "}"}], "\[Rule]", 
                    StyleBox[
                    PaneBox[
                    FractionBox["1", "4"], ContentPadding -> False, 
                    FrameMargins -> 0, StripOnInput -> True, BaselinePosition -> 
                    Baseline, ImageSize -> {{1, 300}, Automatic}], 
                    LineBreakWithin -> False]}]}, {
                    ItemBox[
                    "\"\[VerticalEllipsis]\"", Alignment -> Center, 
                    StripOnInput -> False]}}, 
                    GridBoxAlignment -> {"Columns" -> {{Left}}}, 
                    DefaultBaseStyle -> "Column", 
                    GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}], 
                   "Column"], "SummaryItem"]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("SparseArray[<24>, {6, 6}]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "toyMatrix", "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox["1", "4"], 
      FractionBox["1", "4"], 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"], "0"},
     {
      FractionBox["1", "4"], 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"], 
      FractionBox["1", "4"], "0"},
     {
      FractionBox["1", "4"], 
      FractionBox["1", "4"], 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"], "0"},
     {
      FractionBox["1", "4"], 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"]},
     {
      FractionBox["1", "4"], 
      FractionBox["1", "4"], 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"], "0"},
     {
      FractionBox["1", "4"], 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "4"]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[
   SparseArray[
    Automatic, {6, 6}, 0, {
     1, {{0, 4, 8, 12, 16, 20, 24}, {{1}, {5}, {3}, {2}, {2}, {1}, {5}, {4}, {
       3}, {2}, {1}, {5}, {4}, {2}, {1}, {6}, {5}, {3}, {2}, {1}, {6}, {4}, {
       2}, {1}}}, {
      Rational[1, 4], Rational[1, 4], Rational[1, 4], Rational[1, 4], 
       Rational[1, 4], Rational[1, 4], Rational[1, 4], Rational[1, 4], 
       Rational[1, 4], Rational[1, 4], Rational[1, 4], Rational[1, 4], 
       Rational[1, 4], Rational[1, 4], Rational[1, 4], Rational[1, 4], 
       Rational[1, 4], Rational[1, 4], Rational[1, 4], Rational[1, 4], 
       Rational[1, 4], Rational[1, 4], Rational[1, 4], Rational[
       1, 4]}}]]]]], "Output"]
}, Open  ]],

Cell["The long-term probability of being in each state:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Reverse", "/@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", "25", "}"}], ",", 
        RowBox[{"{", "50", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25", ",", "25"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25", ",", "50"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"25", ",", "25", ",", "25"}], "}"}]}], "}"}]}]}], "}"}], ",", 
   RowBox[{"Grid", "[", 
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{"stateset", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "toyMatrix", "]"}], ",", "1"}], "]"}], 
         "]"}], "]"}]}], "}"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", "}"}], 
     FractionBox["1", "4"]},
    {
     RowBox[{"{", "25", "}"}], 
     FractionBox["1", "4"]},
    {
     RowBox[{"{", "50", "}"}], 
     FractionBox["5", "32"]},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25"}], "}"}], 
     FractionBox["3", "32"]},
    {
     RowBox[{"{", 
      RowBox[{"50", ",", "25"}], "}"}], 
     FractionBox["7", "32"]},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25"}], "}"}], 
     FractionBox["1", "32"]}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["U.S. four-denomination currency", "Subsubsection"],

Cell["Size of the state space:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"PartitionList", "[", "]"}], "]"}]], "Input"],

Cell[BoxData["6720"], "Output"]
}, Open  ]],

Cell["\<\
Compute the transition matrix:
(This took 8 hours to run.  It exports the matrix to a file in your home \
directory.  Alternatively, you can download the matrix from the authors\
\[CloseCurlyQuote] web sites.)\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stateset", "=", 
         RowBox[{"PartitionList", "[", "]"}]}], ",", 
        RowBox[{"prices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "99"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$HomeDirectory", ",", "\"\<US.m\>\""}], "}"}], "]"}], ",", 
        
        RowBox[{"Join", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", "#1", "]"}]}], "}"}], "\[Rule]", 
               FractionBox[
                RowBox[{"Last", "[", "#1", "]"}], 
                RowBox[{"Length", "[", "prices", "]"}]]}], "&"}], ")"}], "/@", 
            RowBox[{"Tally", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"stateset", ",", 
                  RowBox[{"BigSpenderTransaction", "[", 
                   RowBox[{
                    RowBox[{
                    "stateset", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "price"}], "]"}]}], "]"}],
                 "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"{", 
                RowBox[{"price", ",", "prices"}], "}"}]}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "stateset", "]"}]}], "}"}]}], "]"}]}]}], 
       "]"}]}], "]"}], ",", "i"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "28489.2174000000013620592653751373291015625`10.475280432595278", 
   ",", "\<\"US.m\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"USMatrix", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"$HomeDirectory", ",", "\"\<US.m\>\""}], "}"}], "]"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "672000", 
      "\[InvisibleSpace]", "\<\">\"\>"}],
     SequenceForm["<", 672000, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"6720", ",", "6720"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", 
  RowBox[{
   RowBox[{"N", "[", "USMatrix", "]"}], ",", "5"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9999999999999925`", ",", "0.8143337935098672`", ",", 
   "0.7739862575408764`", ",", "0.7237392091785254`", ",", 
   "0.67283745874239`"}], "}"}]], "Output"]
}, Open  ]],

Cell["50 most likely states:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"Reverse", "[", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PartitionList", "[", "]"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["#1", 
              RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
           RowBox[{"First", "[", 
            RowBox[{"Eigenvectors", "[", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}],
              "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", "Last"}], "]"}], 
     "]"}], ",", "50"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "0.010000000000001095`"},
    {
     RowBox[{"{", "1", "}"}], "0.010000000000000633`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.010000000000000257`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "0.010000000000000132`"},
    {
     RowBox[{"{", "}"}], "0.009999999999999115`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.008133382377726978`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.007323727969667524`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.006446544750959825`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.005519677459192763`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005435554102676772`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004757292695616032`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004677673001922373`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.004564445897323146`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004534123611670496`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004480322540808039`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.004397061081214418`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1"}], "}"}], "0.004297273534346968`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004208533456042017`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.004145747890231309`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1"}], "}"}], "0.004050151770541201`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.003913156942565465`"},
    {
     RowBox[{"{", "25", "}"}], "0.003795956872138992`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.0037731669724505707`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.00376584625212026`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.003758395246741432`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.0037478433772645554`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1"}], "}"}], "0.0037173313060685173`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.0036484933478076534`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0036142325930193123`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.0035855009782819265`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1"}], "}"}], "0.003553455249042304`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.003543792673066419`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.0034997269113363765`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.003445146061479793`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.0034339949183389254`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.0033788318629317457`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.0033660830608084266`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0033156937593238132`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.003314065142775736`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.003263243672799188`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.0032381904265993155`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1"}], "}"}], "0.003212673652926085`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.003169189451294688`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "10", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0031543826890394503`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0030731467779651802`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.0030706636132373285`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1"}], "}"}], "0.0030262440100600804`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.0030144999071947207`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.0029919752500511053`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0029760381148212843`"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell["Expected number of coins in your wallet:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Length", ",", "#1", ",", "1"}], "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
         "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["10.045653499218748`"], "Output"]
}, Open  ]],

Cell["Expected number of quarters in your wallet:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "25"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
         "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["1.0599199522420935`"], "Output"]
}, Open  ]],

Cell["Expected number of dimes in your wallet:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "10"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
         "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["1.1522192528047526`"], "Output"]
}, Open  ]],

Cell["Expected number of nickels in your wallet:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "5"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
         "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0.9115735929319613`"], "Output"]
}, Open  ]],

Cell["Expected number of pennies in your wallet:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
         "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["6.921940701239941`"], "Output"]
}, Open  ]],

Cell["Distribution of coins in circulation:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"First", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"6.921940701240068`", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.9115735929319583`", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.1522192528047568`", ",", "10"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.0599199522420897`", ",", "25"}], "}"}]}], "}"}]}], "/", 
  RowBox[{"Total", "[", 
   RowBox[{"First", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"6.921940701240068`", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.9115735929319583`", ",", "5"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.1522192528047568`", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1.0599199522420897`", ",", "25"}], "}"}]}], "}"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6890483234145297`", ",", "0.09074308535555603`", ",", 
   "0.11469828746276693`", ",", "0.10551030376714733`"}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "Distance in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[DoubleStruckCapitalR]", "4"], TraditionalForm]]],
 " from the 2014 U.S. mint production ratios:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EuclideanDistance", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{".689", ",", ".091", ",", ".115", ",", ".106"}], "}"}], ",", 
   RowBox[{"Reverse", "@", 
    RowBox[{"Normalize", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"568", ",", "1676", ",", "1024", ",", "6015"}], "}"}], ",", 
      "Total"}], "]"}]}]}], "]"}]], "Input"],

Cell[BoxData["0.09144173029341986`"], "Output"]
}, Open  ]],

Cell["\<\
Probability of being able to pay with exact change for any price:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{"Total", "[", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"PartitionList", "[", "]"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["#1", 
            RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
         RowBox[{"First", "[", 
          RowBox[{"Eigenvectors", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
           "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"wallet_", "/;", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Total", "/@", 
            RowBox[{"DistinctSubsets", "[", "wallet", "]"}]}], "]"}], 
          "\[Equal]", 
          RowBox[{"Range", "[", 
           RowBox[{"0", ",", "99"}], "]"}]}]}], ",", "p_"}], "}"}], 
      "\[RuleDelayed]", "p"}]}], "]"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "4.60685599999999961795538183650933206081`6.684004550671703", ",", 
   "0.008310350494198582`"}], "}"}]], "Output"]
}, Open  ]],

Cell["Probability of having at least one quarter in your wallet:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "25", ",", "___"}], "}"}], ",", "p_"}], "}"}], 
     "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.6391003074360365`"], "Output"]
}, Open  ]],

Cell["At least one dime:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "10", ",", "___"}], "}"}], ",", "p_"}], "}"}], 
     "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.6337813205395055`"], "Output"]
}, Open  ]],

Cell["At least one nickel:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "5", ",", "___"}], "}"}], ",", "p_"}], "}"}], 
     "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.580852412122965`"], "Output"]
}, Open  ]],

Cell["At least one penny:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "1", ",", "___"}], "}"}], ",", "p_"}], "}"}], 
     "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.9597469825941569`"], "Output"]
}, Open  ]],

Cell["Probability of having only pennies (and a nonempty wallet):", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ".."}], "}"}], ",", "p_"}], "}"}], "\[RuleDelayed]", 
     "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.08430286707633355`"], "Output"]
}, Open  ]],

Cell["\<\
Probability of having no silver coins (only pennies or an empty wallet):\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", "..."}], "}"}], ",", "p_"}], "}"}], "\[RuleDelayed]", 
     "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.09430286707633269`"], "Output"]
}, Open  ]],

Cell["Probability of having an empty wallet:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", "p_"}], "}"}], "\[RuleDelayed]", "p"}]}],
    "]"}], "]"}]], "Input"],

Cell[BoxData["0.010000000000000633`"], "Output"]
}, Open  ]],

Cell["At least two quarters:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "25", ",", "25", ",", "___"}], "}"}], ",", "p_"}],
       "}"}], "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.33682691175982216`"], "Output"]
}, Open  ]],

Cell["At least three quarters:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "25", ",", "25", ",", "25", ",", "___"}], "}"}], 
       ",", "p_"}], "}"}], "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.08399273304623464`"], "Output"]
}, Open  ]],

Cell["At least two dimes:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "10", ",", "10", ",", "___"}], "}"}], ",", "p_"}],
       "}"}], "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.3247630155972642`"], "Output"]
}, Open  ]],

Cell["At least two nickels:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "5", ",", "5", ",", "___"}], "}"}], ",", "p_"}], 
      "}"}], "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.2350911420057999`"], "Output"]
}, Open  ]],

Cell["At least two pennies:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "1", ",", "1", ",", "___"}], "}"}], ",", "p_"}], 
      "}"}], "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.9072820378403357`"], "Output"]
}, Open  ]],

Cell["At least one silver coin:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"25", "|", "10", "|", "5"}], ",", "___"}], "}"}], ",", 
       "p_"}], "}"}], "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.9056971329236675`"], "Output"]
}, Open  ]],

Cell["At least two silver coins:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "USMatrix", "]"}], "]"}], ",", "1"}], 
          "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", 
         RowBox[{"25", "|", "10", "|", "5"}], ",", 
         RowBox[{"25", "|", "10", "|", "5"}], ",", "___"}], "}"}], ",", 
       "p_"}], "}"}], "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.7757275652577196`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Pennyless purchaser", "Subsubsection"],

Cell["Size of the state space:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"PartitionList", "[", 
   RowBox[{"{", 
    RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], "]"}]], "Input"],

Cell[BoxData["213"], "Output"]
}, Open  ]],

Cell["This system is small enough to solve exactly:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"stateprobabilities", "=", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stateset", "=", 
         RowBox[{"PartitionList", "[", 
          RowBox[{"{", 
           RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}]}], ",", 
        RowBox[{"prices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "95", ",", "5"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Reverse", "[", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"stateset", ",", 
            RowBox[{"LinearSolve", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Transpose", "[", 
                  RowBox[{"SparseArray", "[", 
                   RowBox[{"Join", "@@", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"First", "[", "#1", "]"}]}], "}"}], "\[Rule]", 
                    FractionBox[
                    RowBox[{"Last", "[", "#1", "]"}], 
                    RowBox[{"Length", "[", "prices", "]"}]]}], "&"}], ")"}], "/@", 
                    RowBox[{"Tally", "[", 
                    RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"stateset", ",", 
                    RowBox[{"BigSpenderTransaction", "[", 
                    RowBox[{
                    RowBox[{
                    "stateset", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "price"}], "]"}]}], "]"}],
                     "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"price", ",", "prices"}], "}"}]}], "]"}], "]"}]}],
                     ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", 
                    RowBox[{"Length", "[", "stateset", "]"}]}], "}"}]}], 
                    "]"}]}], "]"}], "]"}], "-", 
                 RowBox[{"IdentityMatrix", "[", 
                  RowBox[{"Length", "[", "stateset", "]"}], "]"}]}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"1", ",", 
                  RowBox[{"Length", "[", "stateset", "]"}]}], "]"}]}], "]"}], 
              ",", 
              RowBox[{"UnitVector", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "stateset", "]"}], "+", "1"}], ",", 
                RowBox[{
                 RowBox[{"Length", "[", "stateset", "]"}], "+", "1"}]}], 
               "]"}]}], "]"}]}], "}"}], "]"}], ",", "Last"}], "]"}], "]"}]}], 
     "]"}]}], ";"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2.87512800000000012801137927453964948654`6.479257097420489", ",", "Null"}],
   "}"}]], "Output"]
}, Open  ]],

Cell["50 most likely states:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"MapAt", "[", 
     RowBox[{"N", ",", "#", ",", "2"}], "]"}], "&"}], "/@", 
   RowBox[{"Take", "[", 
    RowBox[{"stateprobabilities", ",", "50"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", "5", "}"}], "0.05`"},
    {
     RowBox[{"{", "}"}], "0.05`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5"}], "}"}], "0.03916645236276158`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5"}], "}"}], "0.030930586506820408`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5"}], "}"}], "0.028471151321470208`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "5"}], "}"}], "0.02731369802427377`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "5"}], "}"}], 
     "0.026256744913522544`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], "0.02536256983196015`"},
    {
     RowBox[{"{", "10", "}"}], "0.024637430168039848`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "5"}], "}"}], 
     "0.024174911478392118`"},
    {
     RowBox[{"{", "25", "}"}], "0.024163269027339222`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "5", ",", "5"}], "}"}], 
     "0.022102826415638127`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "10", ",", "5"}], "}"}], 
     "0.021442734035189485`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5"}], "}"}], "0.02121315575609444`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "10", ",", "5"}], "}"}], 
     "0.021029297926105712`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "10", ",", "5", ",", "5"}], 
      "}"}], "0.019565777974847032`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "10", ",", "5"}], "}"}], 
     "0.01931802527812635`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "10"}], "}"}], "0.018747604277125147`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "10", ",", "5", ",", "5"}], 
      "}"}], "0.017853842261310496`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10"}], "}"}], "0.017540061596812005`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "10", ",", "5"}], "}"}], "0.016998417686983045`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "5"}], "}"}], "0.01671674369470607`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25"}], "}"}], "0.01628146424759004`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "10"}], "}"}], "0.01584035571263198`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "10", ",", "5", ",", "5"}], "}"}], 
     "0.01501611225673146`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5"}], "}"}], 
     "0.014702693980886816`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "10", ",", "10", ",", "5"}], 
      "}"}], "0.014111252043613808`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "10"}], "}"}], 
     "0.013621517860165114`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10"}], "}"}], "0.01357153120593217`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "5"}], "}"}], 
     "0.013551245989512265`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "25", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5"}], 
      "}"}], "0.012252824870959302`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "10", ",", "5", ",", "5"}], "}"}], 
     "0.011813612848764546`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "10", ",", "10", ",", "5"}], "}"}], 
     "0.011777091451193043`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "10", ",", "10"}], "}"}], 
     "0.011265743085105969`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5"}], "}"}], "0.01083354763723842`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "5"}], "}"}], 
     "0.010344267210865609`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "0.010341777232878635`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "25", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "0.010292524450673484`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "10"}], "}"}], 
     "0.009927405894369332`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25"}], "}"}], "0.009718478627008583`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "0.009193808279767098`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5"}], 
      "}"}], "0.0091684103620187`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "10", ",", "10", ",", "5"}], "}"}], 
     "0.009015001650029126`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "0.008063370356562542`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "0.007991696406576767`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "0.00764663444239281`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "10", ",", "10"}], "}"}], 
     "0.007561481059827955`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "10", ",", "10"}], "}"}], 
     "0.007350335688882312`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "25", ",", "10", ",", "10", ",", "10", ",", "10", ",", "5"}],
       "}"}], "0.007050761242176703`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "25", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5", 
       ",", "5"}], "}"}], "0.006926408428968447`"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell["50 least likely states:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"MapAt", "[", 
     RowBox[{"N", ",", "#", ",", "2"}], "]"}], "&"}], "/@", 
   RowBox[{"Take", "[", 
    RowBox[{"stateprobabilities", ",", 
     RowBox[{"-", "50"}]}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", 
       ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "2.3207606680399536`*^-6"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.9678768639706814`*^-6"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5", 
       ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.2071368405034631`*^-6"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5"}], "}"}], "1.2009988890207349`*^-6"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.0900121417513388`*^-6"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "25", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], "1.071340525708105`*^-6"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5"}], "}"}], "1.0015816594695376`*^-6"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5"}], "}"}], "9.53919624368539`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",",
        "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "7.378221325234415`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", 
       ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "4.6313189328579345`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",",
        "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "3.991662226960499`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "3.1781697144028116`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5", 
       ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}],
       "}"}], "2.488869228606659`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.8423546151421558`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.7173265974877726`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], "1.515036248403112`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5"}], "}"}], "1.344287249665343`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",",
        "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.2075814675719878`*^-7"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", 
       ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}],
       "}"}], "7.927098879363715`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "4.481138651873861`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "2.35201947325468`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "2.2718555671691966`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.8654827939519997`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",",
        "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "1.8627449291471918`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], "1.550853995858382`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", 
       ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", 
       ",", "5"}], "}"}], "1.2703954763894727`*^-8"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "5.747998464040657`*^-9"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "2.836272888800366`*^-9"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "2.777331016560371`*^-9"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",",
        "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5"}], "}"}], "2.488024863856853`*^-9"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "2.2044053864589856`*^-9"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.7352852643639035`*^-9"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5"}], "}"}], "3.369297934314675`*^-10"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",",
        "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5"}], "}"}], "3.1286354475559306`*^-10"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "2.8317980426758193`*^-10"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "2.166949001242045`*^-10"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.5715663544885082`*^-10"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5"}], "}"}], "3.486218536512059`*^-11"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5"}], "}"}], "2.59878411587511`*^-11"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5"}], "}"}], "2.0355816088145716`*^-11"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "1.2908970101713303`*^-11"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5"}], "}"}], "3.3751129777772903`*^-12"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5"}], "}"}], "2.28627385522694`*^-12"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5"}], "}"}], "9.908461986698913`*^-13"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5"}], "}"}], "1.7643281240027944`*^-13"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5"}], "}"}], "6.23283519340147`*^-14"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], "1.2775029774463174`*^-14"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5"}], "}"}], "3.964401380506164`*^-15"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5"}], "}"}], "2.0923229508226977`*^-16"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", "5", ",", 
       "5", ",", "5", ",", "5", ",", "5", ",", "5"}], "}"}], 
     "1.1012226056961566`*^-17"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell["Expected number of coins:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Length", ",", "#1", ",", "1"}], "]"}]}], "&"}], ")"}], "/@", 
   "stateprobabilities"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"10694632430721730332419182503043178591739158066293055784028710600182\
807973850871972014368047919365348971121901115517629301618087862072758179618975\
008066530430359979610925516193213832919887438721375053932453553492154991501305\
861733170323619", "/", 
  "286130233658814523818052298520717880483121988850328945745638680989749867620\
882572762434469134271232159403532633395217579476014704802941285884586008330739\
575930438886916331110640555557951260100317856922762341353005240302097773840178\
7077600"}]], "Output"],

Cell[BoxData["3.737679969700144`"], "Output"]
}, Open  ]],

Cell["Expected number of quarters:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "25"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", "stateprobabilities"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"64319494929991838415038533066676554930524322488374704549162383453661\
549391048662680578281668184556610969488512077659747242426931959100026230591297\
672515378873958550750217286575065698302645488186086895599549515396169994694963\
351201516497", "/", 
  "572260467317629047636104597041435760966243977700657891491277361979499735241\
765145524868938268542464318807065266790435158952029409605882571769172016661479\
151860877773832662221281111115902520200635713845524682706010480604195547680357\
41552"}]], "Output"],

Cell[BoxData["1.1239548877363175`"], "Output"]
}, Open  ]],

Cell["Expected number of dimes:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "10"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", "stateprobabilities"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"36238407808672817472880792430897090680525663768132531519744874031111\
195719232399043012501861994903839783159966414960913001179227023866587332984362\
488506535082400044960824820026258054249531731716039746100589719641088382589899\
82843503614181", "/", 
  "286130233658814523818052298520717880483121988850328945745638680989749867620\
882572762434469134271232159403532633395217579476014704802941285884586008330739\
575930438886916331110640555557951260100317856922762341353005240302097773840178\
7077600"}]], "Output"],

Cell[BoxData["1.2665004793545858`"], "Output"]
}, Open  ]],

Cell["Expected number of nickels:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "5"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", "stateprobabilities"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"96370422583871416609479415165491044429009389126526685114902600609715\
273309379973342105094457766178361108286971753463765984470464043277453369774346\
889752699460551189433304246545868564495049778511668363560427643955941337689192\
7832397721147", "/", 
  "715325584147036309545130746301794701207804972125822364364096702474374669052\
206431906086172835678080398508831583488043948690036762007353214711465020826848\
939826097217290827776601388894878150250794642306905853382513100755244434600446\
769400"}]], "Output"],

Cell[BoxData["1.347224602609241`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Quarter hoarder", "Subsubsection"],

Cell["Size of the state space:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"PartitionList", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "10"}], "}"}], "]"}], "]"}]], "Input"],

Cell[BoxData["4125"], "Output"]
}, Open  ]],

Cell["\<\
Delete quarters after each transaction:
(This took 4.5 hours to run.  It exports the matrix to a file in your home \
directory.  Alternatively, you can download the matrix from the authors\
\[CloseCurlyQuote] web sites.)\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stateset", "=", 
         RowBox[{"PartitionList", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5", ",", "10"}], "}"}], "]"}]}], ",", 
        RowBox[{"prices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "99"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$HomeDirectory", ",", "\"\<quarter_hoarder.m\>\""}], "}"}],
          "]"}], ",", 
        RowBox[{"Join", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", "#1", "]"}]}], "}"}], "\[Rule]", 
               FractionBox[
                RowBox[{"Last", "[", "#1", "]"}], 
                RowBox[{"Length", "[", "prices", "]"}]]}], "&"}], ")"}], "/@", 
            RowBox[{"Tally", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"stateset", ",", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{"BigSpenderTransaction", "[", 
                    RowBox[{
                    RowBox[{
                    "stateset", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "price"}], "]"}], ",", 
                    "25"}], "]"}]}], "]"}], "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"{", 
                RowBox[{"price", ",", "prices"}], "}"}]}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "stateset", "]"}]}], "}"}]}], "]"}]}]}], 
       "]"}]}], "]"}], ",", "i"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "16053.42052800000055867712944746017456054688`10.226167495700496", 
   ",", "\<\"quarter_hoarder.m\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"quarterHoarderMatrix", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"$HomeDirectory", ",", "\"\<quarter_hoarder.m\>\""}], "}"}], 
     "]"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "373320", 
      "\[InvisibleSpace]", "\<\">\"\>"}],
     SequenceForm["<", 373320, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"4125", ",", "4125"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", 
  RowBox[{
   RowBox[{"N", "[", "quarterHoarderMatrix", "]"}], ",", "5"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9999999999999988`", ",", "0.8092881948027004`", ",", 
   "0.7773347906810424`", ",", "0.7338049900595693`", ",", 
   "0.6771396058812298`"}], "}"}]], "Output"]
}, Open  ]],

Cell["50 most likely states:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"PartitionList", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "5", ",", "10"}], "}"}], "]"}]}], "}"}], ",", 
   RowBox[{"Grid", "[", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"stateset", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox["#1", 
                RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
             RowBox[{"First", "[", 
              RowBox[{"Eigenvectors", "[", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"Transpose", "[", "quarterHoarderMatrix", "]"}], 
                 "]"}], ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
         "Last"}], "]"}], "]"}], ",", "50"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.011645049224465708`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "0.011295697747731736`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "0.010956826815299747`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.010847823987796797`"},
    {
     RowBox[{"{", "1", "}"}], "0.01062812201084067`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.010395033370952489`"},
    {
     RowBox[{"{", "}"}], "0.010309278350515464`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.009844181967127772`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.009194579626571924`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.008449520460864371`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.007132565043028533`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.0065179189836825436`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.0064287353593638`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1"}], "}"}], "0.006384526094698314`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1"}], "}"}], "0.006373490864796404`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.006140729700007727`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.005690197643580833`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005644353972479993`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.005496309668151764`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.00523022864909689`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.0052223172427042905`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.00512721860593027`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005111196683157105`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.0051001599857208165`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.005092668420544029`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.005067880680842456`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.005054676531341362`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0049497929172634784`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.0049268512208276395`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.0048972360963463754`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.0048611266096313`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.004832609110635251`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "10", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.004742676799055514`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004717945451382219`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1"}], "}"}], "0.00468489239532476`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004567413655767113`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004468055567217346`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1"}], "}"}], "0.004434053743790283`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004410929024017367`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004410421713915215`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.004260185245909724`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0042503533965303365`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.00424570573246943`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004226798707011743`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.004211010483469096`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.004209963055977151`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1"}], "}"}], "0.004199094276256148`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.004195976613308404`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1"}], "}"}], "0.0041690662267555734`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004118382250913159`"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell["Expected number of coins:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Length", ",", "#1", ",", "1"}], "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "10"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "quarterHoarderMatrix", "]"}], "]"}], 
          ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["13.73850332755369`"], "Output"]
}, Open  ]],

Cell["Expected number of dimes:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "10"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "10"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "quarterHoarderMatrix", "]"}], "]"}], 
          ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["1.602470857195181`"], "Output"]
}, Open  ]],

Cell["Expected number of nickels:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "5"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "10"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "quarterHoarderMatrix", "]"}], "]"}], 
          ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["1.205705011545362`"], "Output"]
}, Open  ]],

Cell["Expected number of pennies:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "10"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "quarterHoarderMatrix", "]"}], "]"}], 
          ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["10.930327458813146`"], "Output"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Shallit currency", "Subsubsection"],

Cell["Size of the state space:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"PartitionList", "[", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData["4238"], "Output"]
}, Open  ]],

Cell["The greedy algorithm doesn\[CloseCurlyQuote]t give minimal \
partitions:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BigSpenderTransaction", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", 
   RowBox[{"100", "-", "28"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25", ",", "1", ",", "1", ",", "1"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", "=", "28"}], "}"}], ",", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", "=", "0"}], "}"}], ",", 
     RowBox[{
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"IntegerPartitions", "[", 
          RowBox[{"n", ",", 
           RowBox[{"{", "k", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}]}], "]"}], 
         "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"k", "++"}]}], "]"}], ";", 
      RowBox[{"IntegerPartitions", "[", 
       RowBox[{"n", ",", 
        RowBox[{"{", "k", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}]}], "]"}]}]}], 
    "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"18", ",", "5", ",", "5"}], "}"}], "}"}]], "Output"]
}, Open  ]],

Cell["Make a change table:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"changerules", "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", "=", "0"}], "}"}], ",", 
      RowBox[{
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerPartitions", "[", 
           RowBox[{"n", ",", 
            RowBox[{"{", "k", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}]}], "]"}], 
          "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"k", "++"}]}], "]"}], ";", 
       RowBox[{"n", "\[Rule]", 
        RowBox[{"IntegerPartitions", "[", 
         RowBox[{"n", ",", 
          RowBox[{"{", "k", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}]}], 
         "]"}]}]}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", "99"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}]}], ",", 
   RowBox[{"1", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "1", "}"}], "}"}]}], ",", 
   RowBox[{"2", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"3", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"4", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"5", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "5", "}"}], "}"}]}], ",", 
   RowBox[{"6", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"7", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"8", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"9", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"10", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"11", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"12", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"13", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"14", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"15", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"16", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"17", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"18", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "18", "}"}], "}"}]}], ",", 
   RowBox[{"19", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"20", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"21", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"22", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"23", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"24", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"25", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", "25", "}"}], "}"}]}], ",", 
   RowBox[{"26", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"27", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"28", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"29", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"30", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"31", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"32", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"33", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"34", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}], 
   ",", 
   RowBox[{"35", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"36", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"37", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"38", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"39", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "1", ",", "1", ",", "1"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"40", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"41", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"42", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"43", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"44", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"45", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"46", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"47", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "5", ",", "5", ",", "1"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"48", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"49", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"50", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25"}], "}"}], "}"}]}], ",", 
   RowBox[{"51", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"52", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "1", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"53", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"54", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"55", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"56", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"57", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "1", ",", "1"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"58", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"59", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"60", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"61", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"62", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"63", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "1", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"64", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"65", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "5", ",", "5", ",", "5"}], "}"}], "}"}]}],
    ",", 
   RowBox[{"66", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"67", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "5", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"68", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"69", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"70", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "1", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"71", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"72", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"73", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"74", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"75", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25"}], "}"}], "}"}]}], ",", 
   RowBox[{"76", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "1"}], "}"}], "}"}]}], ",", 
   RowBox[{"77", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"78", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"79", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"80", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5"}], "}"}], "}"}]}], ",", 
   RowBox[{"81", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"82", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5", ",", "5"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"83", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "5", ",", "5", ",", "5"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"84", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"85", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"86", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"87", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"88", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "1", ",", "1"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"89", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18", ",", "5", ",", "5"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"90", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "18"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"91", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"92", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "5", ",", "1"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"93", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18"}], "}"}], "}"}]}], ",", 
   RowBox[{"94", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "1"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"95", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "5"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"96", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "18", ",", "18", ",", "5", ",", "5"}], 
      "}"}], "}"}]}], ",", 
   RowBox[{"97", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "18", ",", "18", ",", "18", ",", "18"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"98", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "5"}], "}"}], 
     "}"}]}], ",", 
   RowBox[{"99", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "5", ",", "1"}], 
      "}"}], "}"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell["Average number of coins per transaction:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Mean", "[", 
  RowBox[{"Length", "/@", 
   RowBox[{"First", "/@", 
    RowBox[{"Last", "/@", "changerules"}]}]}], "]"}], "\n", 
 RowBox[{"N", "[", "%", "]"}]}], "Input"],

Cell[BoxData[
 FractionBox["389", "100"]], "Output"],

Cell[BoxData["3.89`"], "Output"]
}, Open  ]],

Cell["\<\
There is not always a unique way to make change using minimal number of coins:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeleteCases", "[", 
  RowBox[{"changerules", ",", 
   RowBox[{"_", "\[Rule]", 
    RowBox[{"{", "_", "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"77", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5"}], "}"}]}], 
     "}"}]}], ",", 
   RowBox[{"82", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5", ",", "5"}], 
       "}"}]}], "}"}]}], ",", 
   RowBox[{"95", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "1", ",", "1"}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "5"}], 
       "}"}]}], "}"}]}]}], "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "So ",
 StyleBox["BigSpenderBestPartition", "Input"],
 " now also lets us decide between these options (for the spender):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BigSpenderBestPartition", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"25", ",", "25", ",", "25", ",", "1", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5"}], "}"}]}], 
   "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25", ",", "25", ",", "25", ",", "1", ",", "1"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BigSpenderBestPartition", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "1", ",", "1"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5", ",", "5"}], 
     "}"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25", ",", "25", ",", "25", ",", "5", ",", "1", ",", "1"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BigSpenderBestPartition", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "1", ",", "1"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "18", ",", "5"}], 
     "}"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"25", ",", "25", ",", "25", ",", "18", ",", "1", ",", "1"}], 
  "}"}]], "Output"]
}, Open  ]],

Cell[TextData[{
 "It remains to update the use of ",
 StyleBox["GreedyPartition", "Input"],
 " to use the change table instead (for the cashier).\nSince there are two \
minimal partitions in some cases, let\[CloseCurlyQuote]s make things \
interesting by using each half the time."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BigSpenderTransactionList", "[", 
   RowBox[{"pocketpartition_", ",", "price_", ",", "changerules_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"exactorgreaterchangepartitions", ",", "whatwepay"}], "}"}], ",", 
    RowBox[{
     RowBox[{"exactorgreaterchangepartitions", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"DistinctSubsets", "[", "pocketpartition", "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Total", "[", "#1", "]"}], "\[GreaterEqual]", "price"}], 
         "&"}]}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"exactorgreaterchangepartitions", "\[NotEqual]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
        RowBox[{"whatwepay", "=", 
         RowBox[{"BigSpenderBestPartition", "[", 
          RowBox[{"Select", "[", 
           RowBox[{"exactorgreaterchangepartitions", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Total", "[", "#1", "]"}], "\[Equal]", 
              RowBox[{"Min", "[", 
               RowBox[{"Total", "/@", "exactorgreaterchangepartitions"}], 
               "]"}]}], "&"}]}], "]"}], "]"}]}], ";", 
        RowBox[{
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"Sort", "[", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"PocketChange`Private`MultisetComplement", "[", 
               RowBox[{"pocketpartition", ",", "whatwepay"}], "]"}], ",", 
              "#"}], "]"}], "]"}], "]"}], "&"}], "/@", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Total", "[", "whatwepay", "]"}], "-", "price"}], ",", 
           "changerules"}], "]"}]}]}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Reverse", "[", 
          RowBox[{"Sort", "[", 
           RowBox[{"Join", "[", 
            RowBox[{"pocketpartition", ",", "#"}], "]"}], "]"}], "]"}], "&"}],
         "/@", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"100", "-", "price"}], ",", "changerules"}], "]"}]}]}], 
      "]"}]}]}], "]"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BigSpenderTransactionList", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "23", ",", "changerules"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"25", ",", "25", ",", "25", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"18", ",", "18", ",", "18", ",", "18", ",", "5"}], "}"}]}], 
  "}"}]], "Output"]
}, Open  ]],

Cell["\<\
(This took 3 hours to run.  It exports the matrix to a file in your home \
directory.  Alternatively, you can download the matrix from the authors\
\[CloseCurlyQuote] web sites.)\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stateset", "=", 
         RowBox[{"PartitionList", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}]}], ",", 
        RowBox[{"prices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "99"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$HomeDirectory", ",", "\"\<Shallit.m\>\""}], "}"}], "]"}], 
        ",", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"positions", "=", 
                RowBox[{"Position", "[", 
                 RowBox[{"stateset", ",", 
                  RowBox[{"Alternatives", "@@", 
                   RowBox[{"BigSpenderTransactionList", "[", 
                    RowBox[{
                    RowBox[{
                    "stateset", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "price", ",", 
                    "changerules"}], "]"}]}]}], "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"i", ",", 
                    RowBox[{"First", "[", "#1", "]"}]}], "}"}], "\[Rule]", 
                  FractionBox["1", 
                   RowBox[{
                    RowBox[{"Length", "[", "prices", "]"}], " ", 
                    RowBox[{"Length", "[", "positions", "]"}]}]]}], "&"}], 
                ")"}], "/@", "positions"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "stateset", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"price", ",", "prices"}], "}"}]}], "]"}], ",", "2"}], 
         "]"}]}], "]"}]}], "]"}], ",", "i"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"11704.790374`", ",", "\<\"Shallit.m\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ShallitMatrix", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"$HomeDirectory", ",", "\"\<Shallit.m\>\""}], "}"}], "]"}], 
    "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "423917", 
      "\[InvisibleSpace]", "\<\">\"\>"}],
     SequenceForm["<", 423917, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"4238", ",", "4238"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", 
  RowBox[{
   RowBox[{"N", "[", "ShallitMatrix", "]"}], ",", "5"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0000000000000009`", ",", "0.8285529861990103`", ",", 
   "0.7286211094201278`", ",", "0.6867575898789324`", ",", 
   "0.6670475700334676`"}], "}"}]], "Output"]
}, Open  ]],

Cell["50 most likely states:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Grid", "[", 
  RowBox[{"Take", "[", 
   RowBox[{
    RowBox[{"Reverse", "[", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"PartitionList", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], ",", 
          
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["#1", 
              RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
           RowBox[{"First", "[", 
            RowBox[{"Eigenvectors", "[", 
             RowBox[{
              RowBox[{"N", "[", 
               RowBox[{"Transpose", "[", "ShallitMatrix", "]"}], "]"}], ",", 
              "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", "Last"}], 
      "]"}], "]"}], ",", "50"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "0.01000000000000008`"},
    {
     RowBox[{"{", "1", "}"}], "0.010000000000000054`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.010000000000000033`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "0.01000000000000002`"},
    {
     RowBox[{"{", "}"}], "0.009999999999999966`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.007895602032428676`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.007211785928309819`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.007106308775028384`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.006256328116932171`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1"}], "}"}], "0.00618449931086136`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005942716418785104`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0057570428817780624`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005418694867664679`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.005276064187519555`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.0052229299118177735`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "0.005159239055521741`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004840760944478202`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.00476990241835152`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004751891388148117`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.00461314392069123`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.0044976199526066815`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.004295236570415349`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "1"}], "}"}], "0.004292381421066129`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1"}], "}"}], "0.004209853019960255`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1"}], "}"}], "0.004143031163127026`"},
    {
     RowBox[{"{", "5", "}"}], "0.004057283581214811`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.0040154513521070915`"},
    {
     RowBox[{"{", "18", "}"}], "0.0038359353775697584`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.003815500689138778`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.0035734514864853343`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.003303605642534473`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.003281530713197341`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.0032224035049107113`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "5", ",", "1"}], "}"}], 
     "0.0032032289346273285`"},
    {
     RowBox[{"{", 
      RowBox[{
      "18", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.003201688485602611`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.003139417540394179`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.003087000893179032`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.0030771079583011103`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.003058310409733316`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "1"}], "}"}], "0.003050134585689837`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1"}], "}"}], "0.0030497463851291364`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], "0.003049623086885344`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.0029193991080630473`"},
    {
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.0028936912249716727`"},
    {
     RowBox[{"{", 
      RowBox[{
      "5", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1"}], "}"}], "0.002856403382644714`"},
    {
     RowBox[{"{", 
      RowBox[{"18", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.002819040787535076`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.002798361066411101`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.002747135242132435`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.002706817214139349`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "1"}], "}"}], "0.0026830720034908156`"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell["Expected number of coins:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{"Length", ",", "#1", ",", "1"}], "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "ShallitMatrix", "]"}], "]"}], ",", 
          "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["8.63381467158764`"], "Output"]
}, Open  ]],

Cell["Expected number of quarters:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "25"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "ShallitMatrix", "]"}], "]"}], ",", 
          "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0.6582035117637186`"], "Output"]
}, Open  ]],

Cell["Expected number of 18-cent pieces:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "18"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "ShallitMatrix", "]"}], "]"}], ",", 
          "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0.9803389577792984`"], "Output"]
}, Open  ]],

Cell["Expected number of nickels:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "5"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "ShallitMatrix", "]"}], "]"}], ",", 
          "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["2.10088469095877`"], "Output"]
}, Open  ]],

Cell["Expected number of pennies:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Times", "@@", 
      RowBox[{"MapAt", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
       "]"}]}], "&"}], ")"}], "/@", 
   RowBox[{"Thread", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PartitionList", "[", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["#1", 
          RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
       RowBox[{"First", "[", 
        RowBox[{"Eigenvectors", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{"Transpose", "[", "ShallitMatrix", "]"}], "]"}], ",", 
          "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["4.894387511085853`"], "Output"]
}, Open  ]],

Cell[TextData[{
 "Likelihood of having at least one ",
 Cell[BoxData[
  FormBox["18", TraditionalForm]]],
 "-cent piece:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Total", "[", 
  RowBox[{"Cases", "[", 
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"PartitionList", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "5", ",", "18", ",", "25"}], "}"}], "]"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["#1", 
           RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
        RowBox[{"First", "[", 
         RowBox[{"Eigenvectors", "[", 
          RowBox[{
           RowBox[{"N", "[", 
            RowBox[{"Transpose", "[", "ShallitMatrix", "]"}], "]"}], ",", 
           "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"___", ",", "18", ",", "___"}], "}"}], ",", "p_"}], "}"}], 
     "\[RuleDelayed]", "p"}]}], "]"}], "]"}]], "Input"],

Cell[BoxData["0.5642395163225006`"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["The pennies-first big spender", "Subsection"],

Cell[CellGroupData[{

Cell["U.S. four-denomination currency", "Subsubsection"],

Cell["Size of the state space:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"Join", "@@", 
   RowBox[{"Outer", "[", 
    RowBox[{"Join", ",", 
     RowBox[{"PartitionList", "[", 
      RowBox[{"{", 
       RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
     RowBox[{"PartitionList", "[", 
      RowBox[{
       RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}], 
  "]"}]], "Input"],

Cell[BoxData["1065"], "Output"]
}, Open  ]],

Cell["Compute the transition matrix:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"stateset", "=", 
         RowBox[{"Join", "@@", 
          RowBox[{"Outer", "[", 
           RowBox[{"Join", ",", 
            RowBox[{"PartitionList", "[", 
             RowBox[{"{", 
              RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
            RowBox[{"PartitionList", "[", 
             RowBox[{
              RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], 
           "]"}]}]}], ",", 
        RowBox[{"prices", "=", 
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "99"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"$HomeDirectory", ",", "\"\<US-pennies-first.m\>\""}], 
          "}"}], "]"}], ",", 
        RowBox[{"Join", "@@", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"First", "[", "#1", "]"}]}], "}"}], "\[Rule]", 
               FractionBox[
                RowBox[{"Last", "[", "#1", "]"}], 
                RowBox[{"Length", "[", "prices", "]"}]]}], "&"}], ")"}], "/@", 
            RowBox[{"Tally", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"stateset", ",", 
                  RowBox[{"PenniesFirstBigSpenderTransaction", "[", 
                   RowBox[{
                    RowBox[{
                    "stateset", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "price"}], "]"}]}], "]"}],
                 "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
               RowBox[{"{", 
                RowBox[{"price", ",", "prices"}], "}"}]}], "]"}], "]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "stateset", "]"}]}], "}"}]}], "]"}]}]}], 
       "]"}]}], "]"}], ",", "i"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "262.81717400000002271553967148065567016602`8.440253654417495", 
   ",", "\<\"pennies-first_US.m\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"penniesFirstUSMatrix", "=", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"Import", "[", 
    RowBox[{"FileNameJoin", "[", 
     RowBox[{"{", 
      RowBox[{"$HomeDirectory", ",", "\"\<pennies-first_US.m\>\""}], "}"}], 
     "]"}], "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "106500", 
      "\[InvisibleSpace]", "\<\">\"\>"}],
     SequenceForm["<", 106500, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"1065", ",", "1065"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Eigenvalues", "[", 
  RowBox[{
   RowBox[{"N", "[", "penniesFirstUSMatrix", "]"}], ",", "5"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.0000000000000013`", ",", "0.7826880231383553`", ",", 
   "0.6618829064562988`", ",", "0.6463297402300903`", ",", 
   "0.5807457133808631`"}], "}"}]], "Output"]
}, Open  ]],

Cell["50 most likely states:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Outer", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}]}], 
    "}"}], ",", 
   RowBox[{"Grid", "[", 
    RowBox[{"Take", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"SortBy", "[", 
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"stateset", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox["#1", 
                RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
             RowBox[{"First", "[", 
              RowBox[{"Eigenvectors", "[", 
               RowBox[{
                RowBox[{"N", "[", 
                 RowBox[{"Transpose", "[", "penniesFirstUSMatrix", "]"}], 
                 "]"}], ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
         "Last"}], "]"}], "]"}], ",", "50"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1"}], "}"}], "0.010000000000001117`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1"}], "}"}], "0.010000000000001024`"},
    {
     RowBox[{"{", "1", "}"}], "0.010000000000000743`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.010000000000000717`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.010000000000000458`"},
    {
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], "0.010000000000000342`"},
    {
     RowBox[{"{", "5", "}"}], "0.009999999999999641`"},
    {
     RowBox[{"{", "}"}], "0.009999999999999551`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.009999999999998977`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "1"}], "}"}], "0.009999999999998812`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.007833290472821343`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.007833290472820956`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1"}], "}"}], "0.007833290472820728`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.007833290472820437`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5"}], "}"}], "0.007833290472819788`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.006186117301364875`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "1"}], "}"}], 
     "0.00618611730136466`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.006186117301363848`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5"}], "}"}], "0.006186117301363404`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.006186117301363285`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.005694230264367931`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.005694230264367868`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005694230264367246`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5"}], "}"}], "0.005694230264366893`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "5", ",", "1"}], "}"}], "0.0056942302643655735`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.005462739604945701`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "5", ",", "1"}], "}"}], 
     "0.005462739604944391`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}],
      "0.005462739604943986`"},
    {
     RowBox[{"{", 
      RowBox[{
      "10", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.005462739604943911`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "5", ",", "5"}], "}"}], "0.0054627396049436875`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "5"}], "}"}], 
     "0.005251348983132339`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1", ",",
        "1"}], "}"}], "0.005251348983132283`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "5", ",", "1"}], "}"}], 
     "0.005251348983131327`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "25", ",", "10", ",", "5", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.005251348983131078`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "25", ",", "10", ",", "5", ",", "1", ",", "1"}], 
      "}"}], "0.005251348983131001`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1"}], "}"}], "0.005072513965875708`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5"}], "}"}], "0.005072513965874364`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005072513965874358`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.005072513965874346`"},
    {
     RowBox[{"{", 
      RowBox[{"5", ",", "5", ",", "1", ",", "1"}], "}"}], 
     "0.0050725139658743265`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004927486034126237`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1"}], "}"}], "0.004927486034125956`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1"}], "}"}], "0.004927486034125566`"},
    {
     RowBox[{"{", 
      RowBox[{"10", ",", "1", ",", "1", ",", "1"}], "}"}], 
     "0.004927486034125204`"},
    {
     RowBox[{"{", "10", "}"}], "0.004927486034124337`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "5"}], "}"}], 
     "0.004834982295412164`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1"}], 
      "}"}], "0.004834982295411955`"},
    {
     RowBox[{"{", 
      RowBox[{
      "25", ",", "10", ",", "5", ",", "5", ",", "1", ",", "1", ",", "1", ",", 
       "1"}], "}"}], "0.004834982295411457`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "5", ",", "1"}], "}"}], 
     "0.004834982295411396`"},
    {
     RowBox[{"{", 
      RowBox[{"25", ",", "10", ",", "5", ",", "5", ",", "1", ",", "1"}], 
      "}"}], "0.004834982295411067`"}
   },
   AutoDelete->False,
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Grid"]], "Output"]
}, Open  ]],

Cell["Expected number of coins:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Outer", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}]}], 
    "}"}], ",", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"MapAt", "[", 
         RowBox[{"Length", ",", "#1", ",", "1"}], "]"}]}], "&"}], ")"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"stateset", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["#1", 
            RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
         RowBox[{"First", "[", 
          RowBox[{"Eigenvectors", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Transpose", "[", "penniesFirstUSMatrix", "]"}], "]"}], 
            ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input"],

Cell[BoxData["5.7376799696697045`"], "Output"]
}, Open  ]],

Cell["Expected number of quarters:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Outer", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}]}], 
    "}"}], ",", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"#", ",", "25"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
         "]"}]}], "&"}], ")"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"stateset", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["#1", 
            RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
         RowBox[{"First", "[", 
          RowBox[{"Eigenvectors", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Transpose", "[", "penniesFirstUSMatrix", "]"}], "]"}], 
            ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input"],

Cell[BoxData["1.1239548877254601`"], "Output"]
}, Open  ]],

Cell["Expected number of dimes:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Outer", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}]}], 
    "}"}], ",", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"#", ",", "10"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
         "]"}]}], "&"}], ")"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"stateset", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["#1", 
            RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
         RowBox[{"First", "[", 
          RowBox[{"Eigenvectors", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Transpose", "[", "penniesFirstUSMatrix", "]"}], "]"}], 
            ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input"],

Cell[BoxData["1.2665004794284187`"], "Output"]
}, Open  ]],

Cell["Expected number of nickels:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Outer", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}]}], 
    "}"}], ",", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"#", ",", "5"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
         "]"}]}], "&"}], ")"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"stateset", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["#1", 
            RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
         RowBox[{"First", "[", 
          RowBox[{"Eigenvectors", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Transpose", "[", "penniesFirstUSMatrix", "]"}], "]"}], 
            ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input"],

Cell[BoxData["1.3472246025157992`"], "Output"]
}, Open  ]],

Cell["Expected number of pennies:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Outer", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}]}], 
    "}"}], ",", 
   RowBox[{"Total", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Times", "@@", 
        RowBox[{"MapAt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Count", "[", 
            RowBox[{"#", ",", "1"}], "]"}], "&"}], ",", "#1", ",", "1"}], 
         "]"}]}], "&"}], ")"}], "/@", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"stateset", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["#1", 
            RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
         RowBox[{"First", "[", 
          RowBox[{"Eigenvectors", "[", 
           RowBox[{
            RowBox[{"N", "[", 
             RowBox[{"Transpose", "[", "penniesFirstUSMatrix", "]"}], "]"}], 
            ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}]}], "]"}]}], 
  "]"}]], "Input"],

Cell[BoxData["2.000000000000026`"], "Output"]
}, Open  ]],

Cell["\<\
Probability of being able to pay with exact change for any price:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"stateset", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Outer", "[", 
       RowBox[{"Join", ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{"{", 
          RowBox[{"5", ",", "10", ",", "25"}], "}"}], "]"}], ",", 
        RowBox[{"PartitionList", "[", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", "5"}], "]"}], ",", "1"}], "]"}]}]}], 
    "}"}], ",", 
   RowBox[{"Total", "[", 
    RowBox[{"Cases", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"{", 
        RowBox[{"stateset", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["#1", 
             RowBox[{"Total", "[", "#1", "]"}]], "&"}], ")"}], "[", 
          RowBox[{"First", "[", 
           RowBox[{"Eigenvectors", "[", 
            RowBox[{
             RowBox[{"N", "[", 
              RowBox[{"Transpose", "[", "penniesFirstUSMatrix", "]"}], "]"}], 
             ",", "1"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"wallet_", "/;", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Total", "/@", 
             RowBox[{"DistinctSubsets", "[", "wallet", "]"}]}], "]"}], 
           "\[Equal]", 
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "99"}], "]"}]}]}], ",", "p_"}], "}"}], 
       "\[RuleDelayed]", "p"}]}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0.007712494817787082`"], "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
Visible->True,
TrackCellChangeTimes->False,
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 17, \
2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 56, 0, 92, "Title"],
Cell[639, 24, 40, 0, 51, "Subtitle"],
Cell[682, 26, 278, 8, 49, "Subsubtitle"],
Cell[CellGroupData[{
Cell[985, 38, 31, 0, 64, "Section"],
Cell[1019, 40, 211, 4, 49, "Text"],
Cell[1233, 46, 182, 4, 49, "Text"],
Cell[1418, 52, 134, 3, 32, "Input"],
Cell[1555, 57, 690, 18, 49, "Text"],
Cell[2248, 77, 57, 1, 32, "Input"],
Cell[2308, 80, 85, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[2418, 86, 163, 4, 32, "Input"],
Cell[2584, 92, 74, 2, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2707, 100, 51, 0, 64, "Section"],
Cell[CellGroupData[{
Cell[2783, 104, 37, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[2845, 108, 56, 0, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[2926, 112, 333, 10, 28, "Input"],
Cell[3262, 124, 297, 10, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3596, 139, 174, 5, 70, "Input"],
Cell[3773, 146, 187, 6, 47, "Output"],
Cell[3963, 154, 171, 4, 28, "Output"]
}, Open  ]],
Cell[4149, 161, 188, 6, 31, "Text"],
Cell[CellGroupData[{
Cell[4362, 171, 330, 9, 28, "Input"],
Cell[4695, 182, 47, 0, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[4791, 188, 64, 0, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[4880, 192, 640, 19, 87, "Input"],
Cell[5523, 213, 357, 12, 28, "Output"],
Cell[5883, 227, 219, 7, 47, "Output"],
Cell[6105, 236, 209, 5, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[6363, 247, 59, 0, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[6447, 251, 652, 19, 104, "Input"],
Cell[7102, 272, 416, 14, 28, "Output"],
Cell[7521, 288, 251, 8, 48, "Output"],
Cell[7775, 298, 238, 5, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8050, 308, 339, 9, 63, "Input"],
Cell[8392, 319, 31, 0, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[8484, 326, 44, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[8553, 330, 56, 0, 35, "Subsubsection"],
Cell[8612, 332, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[8678, 336, 243, 6, 46, "Input"],
Cell[8924, 344, 50, 1, 48, "Output"],
Cell[8977, 347, 31, 0, 28, "Output"]
}, Open  ]],
Cell[9023, 350, 37, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[9085, 354, 242, 6, 46, "Input"],
Cell[9330, 362, 49, 1, 47, "Output"],
Cell[9382, 365, 32, 0, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[9463, 371, 41, 0, 29, "Subsubsection"],
Cell[9507, 373, 36, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[9568, 377, 952, 28, 63, "Input"],
Cell[10523, 407, 14551, 444, 505, "Output"]
}, Open  ]],
Cell[25089, 854, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[25155, 858, 194, 5, 46, "Input"],
Cell[25352, 865, 52, 1, 48, "Output"],
Cell[25407, 868, 32, 0, 28, "Output"]
}, Open  ]],
Cell[25454, 871, 37, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[25516, 875, 210, 5, 46, "Input"],
Cell[25729, 882, 49, 1, 47, "Output"],
Cell[25781, 885, 32, 0, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[25874, 892, 37, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[25936, 896, 38, 0, 35, "Subsubsection"],
Cell[25977, 898, 28, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[26030, 902, 115, 3, 28, "Input"],
Cell[26148, 907, 346, 11, 28, "Output"]
}, Open  ]],
Cell[26509, 921, 53, 0, 30, "Text"],
Cell[26565, 923, 345, 11, 28, "Input"],
Cell[CellGroupData[{
Cell[26935, 938, 2104, 57, 205, "Input"],
Cell[29042, 997, 9353, 195, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38432, 1197, 71, 1, 28, "Input"],
Cell[38506, 1200, 2024, 57, 163, "Output"]
}, Open  ]],
Cell[40545, 1260, 65, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[40635, 1264, 1006, 30, 108, "Input"],
Cell[41644, 1296, 651, 26, 163, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[42344, 1328, 56, 0, 29, "Subsubsection"],
Cell[42403, 1330, 40, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[42468, 1334, 94, 2, 28, "Input"],
Cell[42565, 1338, 31, 0, 28, "Output"]
}, Open  ]],
Cell[42611, 1341, 233, 5, 68, "Text"],
Cell[CellGroupData[{
Cell[42869, 1350, 1928, 51, 154, "Input"],
Cell[44800, 1403, 152, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44989, 1412, 250, 7, 28, "Input"],
Cell[45242, 1421, 364, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45643, 1438, 123, 3, 28, "Input"],
Cell[45769, 1443, 202, 5, 28, "Output"]
}, Open  ]],
Cell[45986, 1451, 38, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[46049, 1455, 769, 22, 192, "Input"],
Cell[46821, 1479, 7033, 214, 863, "Output"]
}, Open  ]],
Cell[53869, 1696, 56, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[53950, 1700, 725, 22, 51, "Input"],
Cell[54678, 1724, 46, 0, 28, "Output"]
}, Open  ]],
Cell[54739, 1727, 59, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[54823, 1731, 823, 26, 108, "Input"],
Cell[55649, 1759, 46, 0, 28, "Output"]
}, Open  ]],
Cell[55710, 1762, 56, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[55791, 1766, 823, 26, 108, "Input"],
Cell[56617, 1794, 46, 0, 28, "Output"]
}, Open  ]],
Cell[56678, 1797, 58, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[56761, 1801, 822, 26, 108, "Input"],
Cell[57586, 1829, 46, 0, 28, "Output"]
}, Open  ]],
Cell[57647, 1832, 58, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[57730, 1836, 822, 26, 108, "Input"],
Cell[58555, 1864, 45, 0, 28, "Output"]
}, Open  ]],
Cell[58615, 1867, 53, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[58693, 1871, 860, 25, 80, "Input"],
Cell[59556, 1898, 175, 4, 28, "Output"]
}, Open  ]],
Cell[59746, 1905, 188, 6, 31, "Text"],
Cell[CellGroupData[{
Cell[59959, 1915, 365, 10, 46, "Input"],
Cell[60327, 1927, 47, 0, 28, "Output"]
}, Open  ]],
Cell[60389, 1930, 89, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[60503, 1936, 1068, 31, 193, "Input"],
Cell[61574, 1969, 157, 4, 28, "Output"]
}, Open  ]],
Cell[61746, 1976, 74, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[61845, 1980, 787, 24, 165, "Input"],
Cell[62635, 2006, 46, 0, 28, "Output"]
}, Open  ]],
Cell[62696, 2009, 34, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[62755, 2013, 787, 24, 165, "Input"],
Cell[63545, 2039, 46, 0, 28, "Output"]
}, Open  ]],
Cell[63606, 2042, 36, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[63667, 2046, 786, 24, 165, "Input"],
Cell[64456, 2072, 45, 0, 28, "Output"]
}, Open  ]],
Cell[64516, 2075, 35, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[64576, 2079, 786, 24, 51, "Input"],
Cell[65365, 2105, 46, 0, 28, "Output"]
}, Open  ]],
Cell[65426, 2108, 75, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[65526, 2112, 768, 24, 51, "Input"],
Cell[66297, 2138, 47, 0, 28, "Output"]
}, Open  ]],
Cell[66359, 2141, 96, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[66480, 2147, 769, 24, 51, "Input"],
Cell[67252, 2173, 47, 0, 28, "Output"]
}, Open  ]],
Cell[67314, 2176, 54, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[67393, 2180, 741, 23, 51, "Input"],
Cell[68137, 2205, 48, 0, 28, "Output"]
}, Open  ]],
Cell[68200, 2208, 38, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[68263, 2212, 799, 24, 51, "Input"],
Cell[69065, 2238, 47, 0, 28, "Output"]
}, Open  ]],
Cell[69127, 2241, 40, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[69192, 2245, 811, 24, 51, "Input"],
Cell[70006, 2271, 47, 0, 28, "Output"]
}, Open  ]],
Cell[70068, 2274, 35, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[70128, 2278, 799, 24, 51, "Input"],
Cell[70930, 2304, 46, 0, 28, "Output"]
}, Open  ]],
Cell[70991, 2307, 37, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[71053, 2311, 797, 24, 51, "Input"],
Cell[71853, 2337, 46, 0, 28, "Output"]
}, Open  ]],
Cell[71914, 2340, 37, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[71976, 2344, 797, 24, 51, "Input"],
Cell[72776, 2370, 46, 0, 28, "Output"]
}, Open  ]],
Cell[72837, 2373, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[72903, 2377, 830, 25, 51, "Input"],
Cell[73736, 2404, 46, 0, 28, "Output"]
}, Open  ]],
Cell[73797, 2407, 42, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[73864, 2411, 882, 26, 51, "Input"],
Cell[74749, 2439, 46, 0, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[74844, 2445, 44, 0, 29, "Subsubsection"],
Cell[74891, 2447, 40, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[74956, 2451, 160, 4, 28, "Input"],
Cell[75119, 2457, 30, 0, 28, "Output"]
}, Open  ]],
Cell[75164, 2460, 61, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[75250, 2464, 3080, 74, 361, "Input"],
Cell[78333, 2540, 139, 4, 28, "Output"]
}, Open  ]],
Cell[78487, 2547, 38, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[78550, 2551, 245, 7, 28, "Input"],
Cell[78798, 2560, 5857, 186, 863, "Output"]
}, Open  ]],
Cell[84670, 2749, 39, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[84734, 2753, 266, 8, 28, "Input"],
Cell[85003, 2763, 11613, 299, 963, "Output"]
}, Open  ]],
Cell[96631, 3065, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[96697, 3069, 315, 9, 46, "Input"],
Cell[97015, 3080, 540, 8, 80, "Output"],
Cell[97558, 3090, 45, 0, 28, "Output"]
}, Open  ]],
Cell[97618, 3093, 44, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[97687, 3097, 412, 13, 46, "Input"],
Cell[98102, 3112, 535, 8, 80, "Output"],
Cell[98640, 3122, 46, 0, 28, "Output"]
}, Open  ]],
Cell[98701, 3125, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[98767, 3129, 412, 13, 46, "Input"],
Cell[99182, 3144, 539, 8, 80, "Output"],
Cell[99724, 3154, 46, 0, 28, "Output"]
}, Open  ]],
Cell[99785, 3157, 43, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[99853, 3161, 411, 13, 46, "Input"],
Cell[100267, 3176, 537, 8, 80, "Output"],
Cell[100807, 3186, 45, 0, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[100901, 3192, 40, 0, 29, "Subsubsection"],
Cell[100944, 3194, 40, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[101009, 3198, 159, 4, 28, "Input"],
Cell[101171, 3204, 31, 0, 28, "Output"]
}, Open  ]],
Cell[101217, 3207, 244, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[101486, 3216, 2123, 55, 199, "Input"],
Cell[103612, 3273, 166, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103815, 3282, 277, 7, 28, "Input"],
Cell[104095, 3291, 364, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104496, 3308, 138, 4, 28, "Input"],
Cell[104637, 3314, 204, 5, 28, "Output"]
}, Open  ]],
Cell[104856, 3322, 38, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[104919, 3326, 1009, 28, 80, "Input"],
Cell[105931, 3356, 8473, 244, 863, "Output"]
}, Open  ]],
Cell[114419, 3603, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[114485, 3607, 811, 24, 80, "Input"],
Cell[115299, 3633, 45, 0, 28, "Output"]
}, Open  ]],
Cell[115359, 3636, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[115425, 3640, 909, 28, 80, "Input"],
Cell[116337, 3670, 45, 0, 28, "Output"]
}, Open  ]],
Cell[116397, 3673, 43, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[116465, 3677, 908, 28, 80, "Input"],
Cell[117376, 3707, 45, 0, 28, "Output"]
}, Open  ]],
Cell[117436, 3710, 43, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[117504, 3714, 908, 28, 80, "Input"],
Cell[118415, 3744, 46, 0, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[118510, 3750, 41, 0, 29, "Subsubsection"],
Cell[118554, 3752, 40, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[118619, 3756, 173, 5, 28, "Input"],
Cell[118795, 3763, 31, 0, 28, "Output"]
}, Open  ]],
Cell[118841, 3766, 88, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[118954, 3771, 224, 6, 28, "Input"],
Cell[119181, 3779, 94, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[119312, 3786, 840, 26, 46, "Input"],
Cell[120155, 3814, 108, 3, 28, "Output"]
}, Open  ]],
Cell[120278, 3820, 36, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[120339, 3824, 952, 28, 46, "Input"],
Cell[121294, 3854, 14551, 444, 301, "Output"]
}, Open  ]],
Cell[135860, 4301, 56, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[135941, 4305, 194, 5, 46, "Input"],
Cell[136138, 4312, 52, 1, 48, "Output"],
Cell[136193, 4315, 32, 0, 28, "Output"]
}, Open  ]],
Cell[136240, 4318, 102, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[136367, 4324, 152, 4, 28, "Input"],
Cell[136522, 4330, 940, 28, 46, "Output"]
}, Open  ]],
Cell[137477, 4361, 151, 4, 31, "Text"],
Cell[CellGroupData[{
Cell[137653, 4369, 296, 8, 28, "Input"],
Cell[137952, 4379, 106, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138095, 4386, 324, 9, 28, "Input"],
Cell[138422, 4397, 119, 3, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138578, 4405, 326, 9, 28, "Input"],
Cell[138907, 4416, 120, 3, 28, "Output"]
}, Open  ]],
Cell[139042, 4422, 293, 6, 50, "Text"],
Cell[139338, 4430, 2164, 56, 131, "Input"],
Cell[CellGroupData[{
Cell[141527, 4490, 141, 3, 28, "Input"],
Cell[141671, 4495, 241, 7, 28, "Output"]
}, Open  ]],
Cell[141927, 4505, 202, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[142154, 4513, 2163, 55, 165, "Input"],
Cell[144320, 4570, 101, 2, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144458, 4577, 261, 7, 28, "Input"],
Cell[144722, 4586, 364, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145123, 4603, 128, 3, 28, "Input"],
Cell[145254, 4608, 204, 5, 28, "Output"]
}, Open  ]],
Cell[145473, 4616, 38, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[145536, 4620, 879, 25, 80, "Input"],
Cell[146418, 4647, 6292, 198, 863, "Output"]
}, Open  ]],
Cell[152725, 4848, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[152791, 4852, 815, 24, 80, "Input"],
Cell[153609, 4878, 44, 0, 28, "Output"]
}, Open  ]],
Cell[153668, 4881, 44, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[153737, 4885, 913, 28, 80, "Input"],
Cell[154653, 4915, 46, 0, 28, "Output"]
}, Open  ]],
Cell[154714, 4918, 50, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[154789, 4922, 913, 28, 80, "Input"],
Cell[155705, 4952, 46, 0, 28, "Output"]
}, Open  ]],
Cell[155766, 4955, 43, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[155834, 4959, 912, 28, 80, "Input"],
Cell[156749, 4989, 44, 0, 28, "Output"]
}, Open  ]],
Cell[156808, 4992, 43, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[156876, 4996, 912, 28, 80, "Input"],
Cell[157791, 5026, 45, 0, 28, "Output"]
}, Open  ]],
Cell[157851, 5029, 133, 5, 31, "Text"],
Cell[CellGroupData[{
Cell[158009, 5038, 879, 26, 81, "Input"],
Cell[158891, 5066, 46, 0, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[158998, 5073, 51, 0, 44, "Subsection"],
Cell[CellGroupData[{
Cell[159074, 5077, 56, 0, 35, "Subsubsection"],
Cell[159133, 5079, 40, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[159198, 5083, 378, 11, 28, "Input"],
Cell[159579, 5096, 31, 0, 28, "Output"]
}, Open  ]],
Cell[159625, 5099, 46, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[159696, 5103, 2305, 60, 278, "Input"],
Cell[162004, 5165, 164, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162205, 5174, 278, 7, 46, "Input"],
Cell[162486, 5183, 364, 12, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162887, 5200, 138, 4, 28, "Input"],
Cell[163028, 5206, 204, 5, 28, "Output"]
}, Open  ]],
Cell[163247, 5214, 38, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[163310, 5218, 1248, 35, 267, "Input"],
Cell[164561, 5255, 5945, 189, 863, "Output"]
}, Open  ]],
Cell[170521, 5447, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[170587, 5451, 1208, 36, 183, "Input"],
Cell[171798, 5489, 46, 0, 28, "Output"]
}, Open  ]],
Cell[171859, 5492, 44, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[171928, 5496, 1314, 40, 183, "Input"],
Cell[173245, 5538, 46, 0, 28, "Output"]
}, Open  ]],
Cell[173306, 5541, 41, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[173372, 5545, 1314, 40, 183, "Input"],
Cell[174689, 5587, 46, 0, 28, "Output"]
}, Open  ]],
Cell[174750, 5590, 43, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[174818, 5594, 1313, 40, 183, "Input"],
Cell[176134, 5636, 46, 0, 28, "Output"]
}, Open  ]],
Cell[176195, 5639, 43, 0, 30, "Text"],
Cell[CellGroupData[{
Cell[176263, 5643, 1313, 40, 183, "Input"],
Cell[177579, 5685, 45, 0, 28, "Output"]
}, Open  ]],
Cell[177639, 5688, 89, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[177753, 5694, 1493, 43, 238, "Input"],
Cell[179249, 5739, 48, 0, 28, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

