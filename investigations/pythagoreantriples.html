<html><head><title>Pythagorean Triples</title>
<meta name=author value="Eric Rowland">
<meta name=description value="Several elementary theorems are proven regarding the properties and distribution of Pythagorean triples.  Initially the focus is on primitive triples, and then the analysis is extended to triples with a common factor.  Finally a closed form for the computation of the number of triples of which a given integer is the hypotenuse is provided in terms of the exponents of its prime factors.">
<meta name=keywords value="Pythagorean theorem, converse of Pythagorean theorem, Pythagorean triple, primitive Pythagorean triple, right triangle, number theory, modular arithmetic, twin, hypotenuse, legs, sums of squares"></head>
<script language=javascript src=layout.js></script><script language=javascript>expositions("pythagoreantriples"); header("Pythagorean Triples");</script>

<table width=100% cellspacing=10><tr><td width=50% valign=top>
<b>Contents</b><font color=3366ff><ul>
<li><a href=#sectionI>I.  Introduction</a>
<li><a href=#sectionII>II.  Properties of <i>r</i>, <i>s</i>, <i>x</i>, <i>y</i>, and <i>z</i></a>
<li><a href=#sectionIII>III.  Counting Triples</a>
<li><a href=#sectionIV>IV.  Restrictions on Primitive Triples</a>
<li><a href=#references>References</a>
</ul></font>
<td width=50% valign=top>
<b>Supplements and Links</b><font color=3366ff><ul>
<li><a href=triplefinder.html><font color=3366ff>Pythagorean triple finder</font></a> <font color=black>(<a href=calculators.html#pt><font color=3366ff>TI-86</font></a>):  Finds all primitive Pythagorean triples with hypotenuses within a given range.</font>
<li><a href=triplegenerator.html><font color=3366ff>Pythagorean triple generator</font></a> <font color=black>(<a href=calculators.html#pt><font color=3366ff>TI-86</font></a>):  Gives the Pythagorean triple generated by two numbers.</font>
<li><a href=tripleslist.html><font color=3366ff>List of Primitive Pythagorean Triples</font></a>
<li><a href=pythagoreantriples-project.html><font color=11aa00>Pythagorean Triples Project</font></a>
</ul></font></table>


</table><table width=100% cellspacing=10><tr><td>
<br><a id=sectionI></a><center><b><font size=5>I.  Introduction</font></b></center>

<p>The Pythagorean theorem carries the name of the Greek mathematician Pythagoras, who lived in the 6th century BCE, though the theorem had been known elsewhere for some time before.  Although the Pythagorean theorem arose in geometry, we will be concerned strictly with the number theoretic properties of the Pythagorean equation, using the connection to geometry only as a jumping off point.

<p><a id=theorem1></a><b>Theorem 1</b> <i>(Pythagorean Theorem and converse) &nbsp;Let x, y, and z be positive reals.  Then z is the length of the hypotenuse of a right triangle with side lengths x, y, and z if and only if</i>

<a id=equation1></a><table width=100%><tr><td><center><img src=images/pt01.gif width=98 height=23></center><td width=10 align=right>(1)</table>

<p>A <i>Pythagorean triple</i> is an ordered triple (<i>x</i>, <i>y</i>, <i>z</i>) of three positive integers such that <i>x</i><sup>2</sup> + <i>y</i><sup>2</sup> = <i>z</i><sup>2</sup>.  If <i>x</i>, <i>y</i>, and <i>z</i> are relatively prime, then the triple is called <i>primitive</i>.

<p>Let us first note the parity of <i>x</i>, <i>y</i>, and <i>z</i> in primitive triples, that is their values <a href=modulararithmetic.html><font color=3366ff>modulo</font></a> 2.  Since 0<sup>2</sup> &#8801; 0, 1<sup>2</sup> &#8801; 1, 2<sup>2</sup> &#8801; 0, and 3<sup>2</sup> &#8801; 1 mod 4, the only squares modulo 4 are 0 and 1.  Letting <i>X</i> = <i>x</i><sup>2</sup>, <i>Y</i> = <i>y</i><sup>2</sup>, and <i>Z</i> = <i>z</i><sup>2</sup>, we have the following solutions to <i>X</i> + <i>Y</i> &#8801; <i>Z</i> mod 4:

<p><center><table>
<tr><td>0 + 0 &#8801; 0
<tr><td>0 + 1 &#8801; 1
<tr><td>1 + 0 &#8801; 1
</table></center>

<p>(1 + 1 &#8801; 2 is not a solution because 2 is not a square modulo 4.)  The first of these solutions corresponds only to nonprimitive triples &#151; <i>x</i>, <i>y</i>, and <i>z</i> are all divisible by 2.  Therefore any primitive triple corresponds to one of the other two solutions.  In either case, <i>Z</i> is odd, and exactly one of <i>X</i> and <i>Y</i> is always odd.  Thus <i>z</i> is odd, and exactly one of <i>x</i> and <i>y</i> is odd.  To establish a convention, let us say that <i>x</i> is always odd and <i>y</i> is always even, since otherwise we can rename the variables of a given triple to obtain this.  A primitive Pythagorean triple therefore has a unique representation (<i>x</i>, <i>y</i>, <i>z</i>), where <i>y</i> is even and <i>x</i> and <i>z</i> are odd.

<p>Let <i>a</i> = <i>z</i> &#150; <i>x</i> and <i>b</i> = <i>z</i> &#150; <i>y</i>.  Substituting for <i>x</i> and <i>y</i> into <a href=#equation1>(1)</a> gives

<p><center><img src=images/pt02.gif width=173 height=25></center>

<p>or <img src=images/pt03.gif width=125 height=19 align=absmiddle>  In fact, only one of these values for <i>z</i> holds.  The solution <img src=images/pt04.gif width=124 height=19 align=absmiddle> results in <i>x</i> or <i>y</i> being negative, so we take

<p><a id=equation2></a><table width=100%><tr><td><center><img src=images/pt05.gif width=131 height=26></center><td width=10 align=right>(2)</table>

<p>Define

<center><img src=images/pt06.gif width=152 height=23></center>

<p>Then the following hold:

<a id=equation3></a><table width=100%><tr><td><center><img src=images/pt07.gif width=227 height=73></center><td width=10 align=right>(3)</table>

<p>Solving <img src=images/pt08.gif width=128 height=18 align=absmiddle> for <i>r</i> and for <i>s</i>, we find

<p><a id=equation4></a><table width=100%><tr><td><center><img src=images/pt09.gif width=333 height=52></center><td width=10 align=right>(4)</table>

<p>The generators <i>r</i> and <i>s</i> will provide the basis of study for primitive triples.  Most texts use the more common generators <i>m</i> and <i>n</i>, where <i>x</i> = <i>m</i><sup>2</sup> &#150; <i>n</i><sup>2</sup>, <i>y</i> = 2<i>mn</i>, and <i>z</i> = <i>m</i><sup>2</sup> + <i>n</i><sup>2</sup>.  Though I believe <i>r</i> and <i>s</i> as defined above are more natural choices (since they emphasize symmetry in the generators and not in the side lengths), the analysis is the same in the end, as <i>m</i> = <i>r</i> + <i>s</i> and <i>n</i> = <i>r</i>.


</table><table width=100% cellspacing=10><tr><td>
<br><a id=sectionII></a><center><b><font size=5>II.  Properties of <i>r</i>, <i>s</i>, <i>x</i>, <i>y</i>, and <i>z</i></font></b></center>

<p><a id=theorem2></a><b>Theorem 2</b> &nbsp;<i>A Pythagorean triple is primitive if and only if r and s are integers, s is odd, and</i> (<i>r</i>, <i>s</i>) = 1<i>.</i>

<p><b>Proof.</b>  Let (<i>x</i>, <i>y</i>, <i>z</i>) be a primitive Pythagorean triple (with even <i>y</i>).  The quantities <i>z</i> + <i>y</i> and 2<i>y</i> are relatively prime because <i>z</i> and <i>y</i> are relatively prime in primitive triples and <i>z</i> + <i>y</i> is odd.  We have

<p><center><img src=images/pt10.gif width=165 height=26></center>

<p>so <i>z</i> + <i>y</i> and <i>z</i> &#150; <i>y</i> are relatively prime (because any common divisor would also divide 2<i>y</i>).  The Pythagorean relation <a href=#equation1>(1)</a> implies that

<p><center><img src=images/pt11.gif width=143 height=26></center>

<p>so <i>z</i> + <i>y</i> and <i>z</i> &#150; <i>y</i> must both be squares because they are relatively prime.  Therefore <img src=images/pt12.gif width=84 height=23 align=absmiddle> is an odd integer.  By <a href=#equation4>(4)</a>, <i>r</i> is also an integer because

<p><center><img src=images/pt13.gif width=128 height=30></center>

<p>is even.

<br>Now that we have established that <i>r</i> and <i>s</i> are integers for primitive triples, we will show that they are relatively prime.  Let <i>m</i> = (<i>r</i>, <i>s</i>).  Since <i>m</i> divides both <i>r</i> and <i>s</i>, <i>m</i> divides <i>x</i>, <i>y</i>, and <i>z</i> by <a href=#equation3>(3)</a>.  But since <i>x</i> and <i>y</i> (in particular) are relatively prime, this means <i>m</i> = 1.

<p>For the converse, assume <i>s</i> is odd and (<i>r</i>, <i>s</i>) = 1.  Because <img src=images/pt08.gif width=128 height=18 align=absmiddle>, we have that (<i>r</i>, <i>z</i>) = 1, since any divisor of both <i>r</i> and <i>z</i> is a divisor of <i>s</i> but <i>r</i> and <i>s</i> are relatively prime.  By the definition of <i>r</i>, <i>x</i> + 2<i>r</i><sup>2</sup> = <i>z</i>, so similarly (<i>x</i>, <i>z</i>) = 1.  Therefore the triple (<i>x</i>, <i>y</i>, <i>z</i>) is primitive.  &#9632;

<p><a id=corollary1></a><b>Corollary</b> &nbsp;<i>The number of primitive Pythagorean triples is countably infinite.</i>

<p><b>Proof.</b>  Since each relatively prime pair (<i>r</i>, <i>s</i>) with odd <i>s</i> gives a unique primitive triple, it suffices to consider the cardinality of the set <i>S</i> = {(<i>r</i>, <i>s</i>) | <i>r</i> and <i>s</i> are relatively prime and <i>s</i> is odd}.  This set is infinite since for each odd <i>s</i> there is at least one <i>r</i> relatively prime to <i>s</i>, but <i>S</i> is no larger than the rationals (by mapping <i>S</i> injectively into the rationals by sending (<i>r</i>, <i>s</i>) to <i>r</i> / <i>s</i>).  Therefore the set <i>S</i> is countably infinite.  &#9632;

<p><br>Next we will prove several results regarding triples modulo 3, 4, and 5.

<p><a id=remark1></a><b>Remark 1</b> &nbsp;<i>If </i>(<i>x</i>, <i>y</i>, <i>z</i>)<i> is a primitive Pythagorean triple, then y</i> &#8801; 0 mod 4<i>,</i> <i>z</i> &#8801; 1 mod 4<i>, exactly one of </i>{<i>x</i>, <i>y</i>}<i> satisfies k</i> &#8801; 0 mod 3<i>, and exactly one of </i>{<i>x</i>, <i>y</i>, <i>z</i>}<i> satisfies k</i> &#8801; 0 mod 5<i>.</i>

<p><b>Proof.</b>  From <a href=#equation3>(3)</a>, <i>y</i> = 2<i>r</i> (<i>r</i> + <i>s</i>).  Either <i>r</i> is even or <i>r</i> + <i>s</i> is even (since <i>s</i> is odd), so 4 divides <i>y</i>.

<br>As shown above, the only squares modulo 4 are 0 and 1.  Since <i>z</i> = <i>r</i><sup>2</sup> + (<i>r</i> + <i>s</i>)<sup>2</sup> is a sum of two squares and <i>s</i> is odd, there are two possibilities.  If <i>r</i> is odd then <i>z</i> &#8801; 1 + 0 &#8801; 1 mod 4, and if <i>r</i> is even then <i>z</i> &#8801; 0 + 1 &#8801; 1 mod 4.

<p>The only squares modulo 3 are 0 and 1.  With <i>X</i> = <i>x</i><sup>2</sup>, <i>Y</i> = <i>y</i><sup>2</sup>, and <i>Z</i> = <i>z</i><sup>2</sup>, the congruence <i>X</i> + <i>Y</i> &#8801; <i>Z</i> mod 3 has the following solutions:

<center><table>
<tr><td>0 + 0 &#8801; 0
<tr><td>0 + 1 &#8801; 1
<tr><td>1 + 0 &#8801; 1
</table></center>

<p>The first case is nonprimitive, so either <i>x</i><sup>2</sup> or <i>y</i><sup>2</sup> is divisible by 3, and this implies that either <i>x</i> or <i>y</i> is divisible by 3.

<p>The only squares modulo 5 are 0, 1, and 4, so <i>X</i> + <i>Y</i> &#8801; <i>Z</i> mod 5 has solutions (up to permutation of <i>X</i> and <i>Y</i>):
<center><table>
<tr><td>0 + 0 &#8801; 0
<tr><td>0 + 1 &#8801; 1
<tr><td>0 + 4 &#8801; 4
<tr><td>1 + 4 &#8801; 0
</table></center>

<p>Again, the first case is nonprimitive so exactly one side is divisible by 5.  &#9632;
<p>To convince yourself that these are the only three generalizations we can make like this, experiment with different prime moduli with the <a href=triplesmodp.html><font color=3366ff>Tripes Modulo <i>p</i></font></a> JavaScript program.  Larger numbers (7, 11, 13,...) yield no obvious statements about the divisors of the respective triple members.


</table><table width=100% cellspacing=10><tr><td>
<br><a id=sectionIII></a><center><b><font size=5>III.  Counting Triples</font></b></center>

<p><a id=definition2></a><b>Definition</b>  &nbsp;<i>Two triples are</i> siblings <i>if they have a common hypotenuse.</i>

<p>The first such pair of primitive triples stem from the hypotenuse 65 (33<sup>2</sup> + 56<sup>2</sup> = 63<sup>2</sup> + 16<sup>2</sup> = 65<sup>2</sup>):

<center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i>
<tr align=right><td>33<td>56<td>65<td>4<td>3
<tr align=right><td>63<td>16<td>65<td>1<td>7
</table></center>

<p>There are also primitive siblings of the hypotenuse 85:

<center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i>
<tr align=right><td>13<td>84<td>85<td>6<td>1
<tr align=right><td>77<td>36<td>85<td>2<td>7
</table></center>

<p>If we search larger numbers, we can find larger sets of siblings.  There are, for example, four primitive triples with hypotenuse 1105:

<center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i>
<tr align=right><td>47<td>1104<td>1105<td>23<td>1
<tr align=right><td>817<td>744<td>1105<td>12<td>19
<tr align=right><td>943<td>576<td>1105<td>9<td>23
<tr align=right><td>1073<td>264<td>1105<td>4<td>29
</table></center>

<p>In general, the number of primitive Pythagorean triples of hypotenuse <i>n</i> is dependent on the number of prime factors of <i>n</i> that are congruent to 1 modulo 4.  It turns out that only powers of 2 appear as these numbers.  The numbers in the <a href=http://www.research.att.com/cgi-bin/access.cgi/as/njas/sequences/eisA.cgi?Anum=006278><font color=772266>sequence</font></a> 5, 65, 1105, 32045, 1185665, 48612265, 2576450045,... are the smallest hypotenuses that harbor 1, 2, 4, 8, 16, 32, 64,... primitive Pythagorean triples.  The terms are given by multiplying successive primes that satisfy <i>p</i> &#8801; 1 mod 4:

<p><center><img src=images/pt14.gif width=198 height=143></center>

<p>The hypotenuse 32045 has eight primitive triples:

<center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i>
<tr align=right><td>2277<td>31964<td>32045<td>122<td>9
<tr align=right><td>8283<td>30956<td>32045<td>109<td>33
<tr align=right><td>17253<td>27004<td>32045<td>86<td>71
<tr align=right><td>21093<td>24124<td>32045<td>74<td>89
<tr align=right><td>23067<td>22244<td>32045<td>67<td>99
<tr align=right><td>27813<td>15916<td>32045<td>46<td>127
<tr align=right><td>31323<td>6764<td>32045<td>19<td>159
<tr align=right><td>32037<td>716<td>32045<td>2<td>177
</table></center>

<p>But why do primitive triples form only in sets of 2<sup><i>&alpha;</i></sup>, and what is the connection to primes <i>p</i> &#8801; 1 mod 4?  Let us look at the prime factors of <i>n</i> more closely.

<p>By examining the <a href=tripleslist.html><font color=3366ff>data</font></a>, it appears that the prime factors of each hypotenuse satisfy <i>p</i> &#8801; 1 mod 4.  Further, each prime hyptenuse holds only one triple, and the more factors a hypotenuse has, the more triples it holds.  Specifically, if <i>&omega;</i>(<i>n</i>) is the number of distinct prime factors of <i>n</i> and all of the prime factors of <i>n</i> satisfy <i>p</i> &#8801; 1 mod 4, then <i>n</i> appears to be the hypotenuse of exactly 2<sup><i>&omega;</i>(<i>n</i>) &#150; 1</sup> primitive Pythagorean triples.  (If <i>n</i> has any prime factors <i>p</i> &#8801; 2 or 3 mod 4, then <i>n</i> is not the hypotenuse of any primitive triples.)  In light of this, it makes sense that the first sibling sets of order 2<sup><i>&alpha;</i></sup> will be found on the multiples of the first <i>&alpha;</i> primes that satisfy <i>p</i> &#8801; 1 mod 4.

<p>Of course, explaining where 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> arises is more tricky.  Some experimentation shows that, for <i>n</i> with the above criteria, <a href=#equation3>(3)</a> has 2<sup><i>&omega;</i>(<i>n</i>) &#150; 1</sup> positive integral solutions for <i>r</i> and <i>s</i>.  We are interested in solutions to <i>n</i> = <i>r</i><sup>2</sup> + (<i>r</i> + <i>s</i>)<sup>2</sup> where <i>r</i> and <i>r</i> + <i>s</i> are relatively prime (or, equivalently, (<i>r</i>, <i>s</i>) = 1).  To see what is happening, first let us quote a theorem attributed to Fermat, the proof of which we leave to a book covering introductory number theory.

<p><a id=theorem3></a><b>Theorem 3</b> <i>(Fermat) &nbsp;Let p be a prime such that p</i> &#8801; 1 mod 4<i>.  Then p can be expressed uniquely as a sum of two squares.</i>

<p>By "uniquely" it is meant that there exist unique integers <i>a</i> and <i>b</i> such that 0 &#60; <i>a</i> &#60; <i>b</i> and <i>p</i> = <i>a</i><sup>2</sup> + <i>b</i><sup>2</sup>.  Using Fermat's theorem, we decompose a number <i>n</i> into is prime factors and write each prime as a sum of two squares.  We then make use of the <a href=http://mathworld.wolfram.com/FibonacciIdentity.html><font color=772266>Fibonacci identity</font></a>,

<p><a id=equation5></a><table width=100%><tr><td><center><img src=images/pt15.gif width=305 height=29></center><td width=10 align=right>(5)</table>

<p>by which we can write the product of sums of two squares again as the sum of two squares.  Multiplying together the sum of squares representations for the prime factors of <i>n</i> gives a sum of squares representation for <i>n</i>, and since the hypotenuse of a primitive triple is a sum <i>r</i><sup>2</sup> + (<i>r</i> + <i>s</i>)<sup>2</sup> of two squares (by <a href=#equation3>(3)</a>), we will be able to generate primitive triples of hypotenuse <i>n</i> simply by knowing the sum of squares representations of the prime factors of <i>n</i>.

<p>For example, for <i>n</i> = 1105,

<p><center><img src=images/pt16.gif width=351 height=48></center>

<p>This solution corresponds to <i>r</i> = 23, <i>s</i> = 1, which generate the triple (47, 1104, 1105).  The other solutions to 1105 = <i>r</i><sup>2</sup> + (<i>r</i> + <i>s</i>)<sup>2</sup> can be obtained by changing the order in which the factors are multiplied together and by reversing the sum of squares expressions of some factors.

<p>Actually counting the solutions that we get in this way is cumbersome, however.  The system is not a very natural one, and "Fibonacci multiplication" is in fact not even associative.  Much better are the Gaussian integers &#151; complex numbers of the form <i>a</i> + <i>bi</i>, where <i>a</i> and <i>b</i> are ordinary integers and <i>i</i><sup>2</sup> = &#150;1.  By Fermat's theorem, each prime factor <i>p</i> &#8801; 1 mod 4 of <i>n</i> conveniently has the representation <i>p</i> = <i>a</i><sup>2</sup> + <i>b</i><sup>2</sup> = (<i>a</i> + <i>bi</i>) (<i>a</i> &#150; <i>bi</i>).  Multiplying two Gaussian integers exactly results in the Fibonacci identity:

<p><center><img src=images/pt17.gif width=285 height=24></center>

<p>Rather than multiplying sum of squares representations, we will multiply Gaussian integers.  We obtain the four solutions to 1105 = <i>r</i><sup>2</sup> + (<i>r</i> + <i>s</i>)<sup>2</sup> by multiplying (Gaussian) "halves" of its (integer) factors <i>p</i> = (<i>a</i> + <i>bi</i>) (<i>a</i> &#150; <i>bi</i>) .  For each of the three primes dividing 1105, we have two choices of which Gaussian factor to take.  Complex conjugation of a solution does not change the sum of squares representation, so we can choose the first such factor to have positive imaginary part.  The solutions are then

<p><center><img src=images/pt18.gif width=253 height=99></center>

<p>By multiplying each by its complex conjugate, these correspond to the four representations of 1105 as a sum of two relatively prime squares (and thus to the four primitive triples with hypotenuse 1105).

<!--<p>We prove the result by this general method.  But first let us state (without proof) what is true about primes in the Gaussian integers <b>Z</b>[<i>i</i>] = {<i>a</i> + <i>bi</i> | <i>a</i>, <i>b</i> are integers}.  <b>Z</b>[<i>i</i>] is a unique factorization domain, so every Gaussian integer has a factorization into primes that are unique up to multiplication by the units &#177;1, &#177;<i>i</i>.

<p><a id=fact1></a><b>Fact</b> &nbsp;<i>Let w be a Gaussian prime and let p </i>= |<i>w</i>|<i>.  Then p is prime and exactly one of the following holds for some integer m:<ol>
<li>p </i>&#8801; 3 mod 4<i>, in which case w </i>= <i>i<sup>m</sup>p;
<li>p </i>&#8801; 1 mod 4<i>, in which case ww</i><sup>&#150;</sup> =<i> p</i><img src= align=absmiddle><i>;
<li>p </i>= 2, in which case w</i> = &#177;(1 &#177; <i>i</i>)<i>.</i>
</ol>
-->

<p><a id=proposition1></a><b>Proposition</b> &nbsp;<i>Let n </i>&#62; 1<i> be a natural number whose prime factors all satisfy p</i> &#8801; 1 mod 4<i>.  Then the number of distinct ways that n can be expressed as a sum <i>a</i><sup>2</sup> + <i>b</i><sup>2</sup> of two squares with <i>a</i> and <i>b</i> are relatively prime is </i>2<sup><i>&omega;</i>(<i>n</i>) &#150; 1</sup><i>, where &omega;</i>(<i>n</i>)<i> is the number of distinct prime factors of n.</i>

<!--<p><b>Proof.</b>  Consider the set <b>Z</b>[<i>i</i>] of Gaussian integers.  Define an equivalence relation ~ on <b>Z</b>[<i>i</i>], where <i>p</i> ~ <i>q</i> if the sets {|Re <i>p</i>|, |Im <i>p</i>|} and {|Re <i>q</i>|, |Im <i>q</i>|} are the same.  That is, <i>p</i> ~ <i>q</i> if and only if

<p><center><img src=images/pt19.gif width=163 height=25></center>

<p>for some integer <i>m</i>, where <img src=images/pt20.gif width=11 height=20 align=absmiddle> is the complex conjugate of <i>q</i>.  The motivation of this definition is that two equivalent Gaussian integers <i>a</i><sub>1</sub> + <i>b</i><sub>1</sub><i>i</i> and <i>a</i><sub>2</sub> + <i>b</i><sub>2</sub><i>i</i> give rise to the same sum of squares representation <i>a</i><sub>1</sub><sup>2</sup> + <i>b</i><sub>1</sub><sup>2</sup> = <i>a</i><sub>2</sub><sup>2</sup> + <i>b</i><sub>2</sub><sup>2</sup>, and conversely.  Since <img src=images/pt21.gif width=56 height=20 align=absmiddle> and <img src=images/pt22.gif width=61 height=20 align=absmiddle> we have

<p><a id=equation6></a><table width=100%><tr><td><center><img src=images/pt23.gif width=170 height=20></center><td width=10 align=right>(6)</table>

<p>In general

<p><a id=equation7></a><table width=100%><tr><td><center><img src=images/pt24.gif width=62 height=23></center><td width=10 align=right>(7)</table>

<p>Therefore, a product of Gaussian integers is equivalent to the same product but where an even number of conjugations have been performed to the terms being multiplied.  In other words, let <i>q</i><sub><i>j</i></sub> = <i>f</i><sub><i>j</i></sub>(<i>p</i><sub><i>j</i></sub>), where each <i>f</i><sub><i>j</i></sub> is either the identity map or complex conjugation.  For each <i>j</i>, let <i>e</i><sub><i>j</i></sub> = 0 if <i>f</i><sub><i>j</i></sub> is the identity map and <i>e</i><sub><i>j</i></sub> = 1 if <i>f</i><sub><i>j</i></sub> is complex conjugation.  Then for any integer <i>m</i>,

<p><center><img src=images/pt25.gif width=177 height=22></center>

<p>if <i>e</i><sub>1</sub> + <i>e</i><sub>2</sub> + ... + <i>e</i><sub><i>k</i></sub> is even, and, provided the <i>p</i><sub><i>j</i></sub>'s are pairwise nonequivalent,

<p><center><img src=images/pt26.gif width=176 height=22></center>

<p>otherwise.

<p>Every sum of squares representation of <i>z</i> can be factored into a product of some number of sum of squares representations by <a href=#equation5>(5)</a>, and since this factorization into indivisible sum of squares representations is the same as factorization in the Gaussian integers, it is unique.  Moreover, each sum of squares representation corresponds to a prime factor of <i>z</i>.  Therefore it suffices to count the number of sum of squares representations that can be obtained as products of those of the prime factors of <i>z</i>, for this is all of them.

<p>Let <i>z</i> &#8801; 1 mod 4 be prime.  By Fermat's theorem, <i>z</i> has exactly 1 = 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> representation as a sum of two squares.

<p>For simplicity of notation, if <i>p</i> &#8801; 1 mod 4 is a prime and <i>p</i> = <i>a</i><sup>2</sup> + <i>b</i><sup>2</sup> with 0 &#60; <i>a</i> &#60; <i>b</i>, then let <i>p</i><sup>+</sup> = <i>a</i> + <i>bi</i> and <i>p</i><sup>&#150;</sup> = <i>a</i> &#150; <i>bi</i>.

<p>We now proceed by induction on the number of prime factors <i>k</i> of <i>z</i> (counting multiplicity).  Let all prime factors of <i>z</i> = <i>p</i><sub>1</sub> <i>p</i><sub>2</sub> ... <i>p</i><sub><i>k</i> &#150; 1</sub> satisfy <i>p</i> &#8801; 1 mod 4, and assume that <i>z</i> has exactly 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> sum of squares representations.  Consider <i>z'</i> = <i>z</i> &#183; <i>p</i><sub><i>k</i></sub> for some prime <i>p</i><sub><i>k</i></sub> &#8801; 1 mod 4.  If <i>p</i><sub><i>k</i></sub> is distinct from <i>p</i><sub><i>j</i></sub> for all <i>j</i> &#60; <i>k</i>, then <i>z'</i> has exactly 2<sup><i>&omega;</i>(<i>z'</i>) &#150; 1</sup> = 2 &#183; 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> sum of squares representations, since the introduction of the two additional conjugate factors <img src=images/pt27.gif width=20 height=22 align=absmiddle> and <img src=images/pt28.gif width=19 height=22 align=absmiddle> doubles the number of representations, by <a href=#equation6>(6)</a> and <a href=#equation7>(7)</a>.  If <i>p</i><sub><i>k</i></sub> = <i>p</i><sub><i>j</i></sub> for some <i>j</i> then no additional representations are obtained because <img src=images/pt29.gif width=94 height=24 align=absmiddle> (so multiplying one of each results in either a purely real or a purely imaginary integer).  Thus <i>z'</i> has exactly 2<sup><i>&omega;</i>(<i>z'</i>) &#150; 1</sup> = 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> sum of squares representations.  &#9632;
-->

<p>This result allows us to count triples of a given hypotenuse:  Because <i>z</i> has 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> sum of squares representations when all its factors satisfy <i>p</i> &#8801; 1 mod 4, there are 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> distinct solutions to <a href=#equation3>(3)</a>.  In each of these solutions, <i>r</i> and <i>s</i> are relatively prime (because <i>r</i> + <i>si</i> is not divisible by any integer prime) and <i>s</i> is odd (because an even <i>s</i> results in an even <i>z</i>).  Therefore <i>z</i> is the hypotenuse of exactly 2<sup><i>&omega;</i>(<i>z</i>) &#150; 1</sup> primitive Pythagorean triples.  Not only does it allow counting, however, but it provides an algorithm to actually construct the triples given the sums of square representations of its prime factors.  A simple program can readily compute, for example, the 2<sup>14</sup> = 16384 primitive triples with hypotenuse <i>n</i> = 16880412096169215173498945, which is the product of the first fifteen primes that satisfy <i>p</i> &#8801; 1 mod 4.

<p><br>Until now we have considered triples based only on <i>z</i>; with what we have learned it is now easy to understand them sorted also by <i>x</i> or by <i>y</i> (where "P" denotes a prime leg and "<b>P</b>" denotes a prime power leg):

<center><table cellpadding=3>
<tr align=center>
	<td><b><i>x</i></b><td><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i><td rowspan=11> &nbsp; &nbsp; 
	<td><b><i>x</i></b><td><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i><td rowspan=11><img src=images/whitespace-horizontal.gif width=48 height=1>
	<td><i>x</i><td><b><i>y</i></b><td><td><i>z</i><td><i>r</i><td><i>s</i><td rowspan=11> &nbsp; &nbsp; 
	<td><i>x</i><td><b><i>y</i></b><td><td><i>z</i><td><i>r</i><td><i>s</i>
<tr align=right>
	<td>3<td>P<td>4<td>5<td>1<td>1
	<td>21<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>20<td>29<td>2<td>3
	<td>3<td>4<td><b>P</b><td>5<td>1<td>1
	<td>45<td>28<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>53<td>2<td>5
<tr align=right>
	<td>5<td>P<td>12<td>13<td>2<td>1
	<td>21<td>220<td>221<td>10<td>1
	<td>15<td>8<td><b>P</b><td>17<td>1<td>3
	<td>195<td>28<td>197<td>1<td>13
<tr align=right>
	<td>7<td>P<td>24<td>25<td>3<td>1
	<td>23<td>P<td>264<td>265<td>11<td>1
	<td>5<td>12<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>13<td>2<td>1
	<td>255<td>32<td><b>P</b><td>257<td>1<td>15
<tr align=right>
	<td>9<td><b>P</b><td>40<td>41<td>4<td>1
	<td>25<td><b>P</b><td>312<td>313<td>12<td>1
	<td>35<td>12<td>37<td>1<td>5
	<td>77<td>36<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>85<td>2<td>7
<tr align=right>
	<td>11<td>P<td>60<td>61<td>5<td>1
	<td>27<td><b>P</b><td>364<td>365<td>13<td>1
	<td>63<td>16<td><b>P</b><td>65<td>1<td>7
	<td>323<td>36<td>325<td>1<td>17
<tr align=right>
	<td>13<td>P<td>84<td>85<td>6<td>1
	<td>29<td>P<td>420<td>421<td>14<td>1
	<td>21<td>20<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>29<td>2<td>3
	<td>9<td>40<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>41<td>4<td>1
<tr align=right>
	<td>15<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>8<td>17<td>1<td>3
	<td>31<td>P<td>480<td>481<td>15<td>1
	<td>99<td>20<td>101<td>1<td>9
	<td>399<td>40<td>401<td>1<td>19
<tr align=right>
	<td>15<td>112<td>113<td>7<td>1
	<td>33<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>56<td>65<td>4<td>3
	<td>7<td>24<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>25<td>3<td>1
	<td>117<td>44<td rowspan=2><img src=images/bracket-top.gif width=9 height=19><br><img src=images/bracket-bottom.gif width=9 height=19><td>125<td>2<td>9
<tr align=right>
	<td>17<td>P<td>144<td>145<td>8<td>1
	<td>33<td>544<td>545<td>16<td>1
	<td>143<td>24<td>145<td>1<td>11
	<td>483<td>44<td>485<td>1<td>21
<tr align=right>
	<td>19<td>P<td>180<td>181<td>9<td>1
</table></center>

<p>Very similar to the case of <i>z</i>, the prime factors of a given <i>x</i> determine how many triples have <i>x</i> as a leg (without the restriction that the prime factors must satisfy <i>p</i> &#8801; 1 mod 4):  If <i>x</i> &#8801; 1 mod 2, then <i>x</i> is a leg of 2<sup><i>&omega;</i>(<i>x</i>) &#150; 1</sup> primitive triples.  And if <i>y</i> &#8801; 0 mod 4, then <i>y</i> is a leg of 2<sup><i>&omega;</i>(<i>y</i>) &#150; 1</sup> primitive triples.

<p><a id=theorem3></a><b>Theorem 3</b> &nbsp;<i>Let &omega;</i>(<i>n</i>)<i> be the number of distinct prime factors of a natural number n</i> &#62; 1<i>.  The number of primitive Pythagorean triples of which n is a member is</i>

<a id=equation8></a><p><table width=100%><tr><td><center><img src=images/pt30.gif width=569 height=92></center><td width=10 align=right>(8)</table>

<p><br>We now generalize the problem of counting to include nonprimitive triples.  (For a nonprimitive triple, <i>r</i> and <i>s</i> are irrational unless the common factor of the triple is a square.)

<p><a id=theorem4></a><b>Theorem 4</b> &nbsp;<i>If the natural number z decomposes into distinct primes as

<p><center><img src=images/pt31.gif width=224 height=30></center>

<p>with p<sub>i</sub></i> &#8801; 1 mod 4<i> for all i and q<sub>j</sub></i> &#8801; 3 mod 4<i> for all j, then z is the hypotenuse of exactly

<a id=equation9></a><table width=100%><tr><td><center><img src=images/pt32.gif width=219 height=62></center><td width=10 align=right>(9)</table>

Pythagorean triples.</i>

<p><b>Proof.</b>  Let <i>z</i> be a natural number.  Since primes <i>q</i> &#8801; 3 mod 4 and the prime 2 do not contribute to primitive triples, these factors in <i>z</i> do not contribute to the total number of triples with hypotenuse <i>z</i> (i.e., removing all of these factors from a given <i>z</i> results in an integer that is the hypotenuse of the same number of triples as <i>z</i>).  Therefore it suffices to consider natural numbers of the form <img src=images/pt33.gif width=149 height=19 align=absmiddle> with <i>p</i><sub><i>i</i></sub> &#8801; 1 mod 4 for each <i>i</i>.  The number of divisors of <i>z</i> that can be written as a product of powers of exactly <i>j</i> primes is <i>&sigma;</i><sub><i>j</i></sub>(<i>&alpha;</i><sub>1</sub>,<i>&alpha;</i><sub>2</sub>,...,<i>&alpha;</i><sub><i>k</i></sub>), the <i>j</i>th <a href=http://mathworld.wolfram.com/SymmetricPolynomial.html><font color=772266>elementary symmetric polynomial</font></a> on the exponents <i>&alpha;</i><sub>1</sub>, <i>&alpha;</i><sub>2</sub>, ..., <i>&alpha;</i><sub><i>k</i></sub>.  Each such divisor <i>d</i> of <i>z</i> is the hypotenuse of 2<sup><i>&omega;</i>(<i>d</i>) &#150; 1</sup> = 2<sup><i>j</i> &#150; 1</sup> primitive triples, by <a href=#theorem3>Theorem 3</a>, and so contributes 2<sup><i>j</i> &#150; 1</sup> nonprimitive triples of hypotenuse <i>z</i> by simply multiplying by <i>z</i> / <i>d</i>.  Thus, by a property of the elementary symmetric polynomials,

<p><table width=100%><tr><td><center><img src=images/pt34.gif width=291 height=171></center><td width=10 align=right valign=bottom>&#9632;</table>

<p>For example, 3142875 = 3 &#183; 5<sup>3</sup> &#183; 17<sup>2</sup> &#183; 29 is the hypotenuse of exactly <i>T</i>(3142875) = ((2 &#183; 3 + 1) (2 &#183; 2 + 1) (2 &#183; 1 + 1) &#150; 1) / 2 = 52 Pythagorean triples.

<p><a id=corollary2></a><b>Corollary</b> &nbsp;<i>Let z</i> = <i>Q p</i><sub>1</sub> <i>p</i><sub>2</sub> ... <i>p</i><sub><i>k</i></sub> &#62; 1<i> be a natural number with exactly k distinct prime factors satisfying p </i>&#8801; 1 mod 4<i> and no factor of the form p</i><sup>2</sup><i> for any prime p </i>&#8801; 1 mod 4<i>.  Then the number of Pythagorean triples with hypotenuse z is T</i>(<i>z</i>) = (3<sup><i>k</i></sup> &#150; 1) / 2<i>.</i>


</table><table width=100% cellspacing=10><tr><td>
<br><a id=sectionIV></a><center><b><font size=5>IV.  Restrictions on Primitive Triples</font></b></center>

<p>In this section we will be interested in triples that satisfy certain conditions.  Sometimes a triple that has a pair of sides with only a unit difference is referred to as a "twin."  For example, the triples (3, 4, 5), (5, 12, 13), (7, 24, 25), and (21, 20, 29) each have a pair of sides that differ by 1.  By browsing <a href=tripleslist.html><font color=3366ff>data</font></a>, one finds that triples satisfying <i>z</i> &#150; <i>y</i> = 1 are more common than those satisfying |<i>x</i> &#150; <i>y</i>| = 1.  There are infinitely many of both types, but the latter much less densely populate the world of primitive triples.

<p>To find triples with <i>b</i> = <i>z</i> &#150; <i>y</i> = 1, we solve <i>x</i><sup>2</sup> + (<i>z</i> &#150; 1)<sup>2</sup> = <i>z</i><sup>2</sup> for <i>z</i> to find

<p><a id=equation10></a><table width=100%><tr><td><center><img src=images/pt35.gif width=87 height=44></center><td width=10 align=right>(10)</table>

<p>Any odd <i>x</i> then gives such a triple.  Substituting this into the definition of <i>r</i> gives 

<p><center><img src=images/pt36.gif width=257 height=55></center>

<p>Since <i>s</i> = &#8730;<i>b</i> = 1, the first few triples with <i>b</i> = 1 are:

<center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i>
<tr align=right><td>3<td>4<td>5<td>1<td>1
<tr align=right><td>5<td>12<td>13<td>2<td>1
<tr align=right><td>7<td>24<td>25<td>3<td>1
<tr align=right><td>9<td>40<td>41<td>4<td>1
<tr align=right><td>11<td>60<td>61<td>5<td>1
<tr align=right><td>13<td>84<td>85<td>6<td>1
</table></center>

<p>Moreover, the sequence of <i>y</i> values is 4 times the <a href=http://www.research.att.com/cgi-bin/access.cgi/as/njas/sequences/eisA.cgi?Anum=000217><font color=772266>triangular numbers</font></a>, since, by <a href=#equation3>(3)</a>,

<p><center><img src=images/pt37.gif width=200 height=44></center>

<p>This same procedure can be used for any valid <i>a</i> or <i>b</i> value because the resulting equation will always be linear in <i>z</i>.  From <a href=#equation3>(3)</a> we see that the <i>n</i>th triples with fixed <i>a</i> and <i>b</i> values are given by

<p><a id=equation11></a><table width=100%><tr><td><center><img src=images/pt38.gif width=485 height=111></center><td width=10 align=right>(11)</table>

<p><br>We now turn to primitive triples with the restriction that |<i>x</i> &#150; <i>y</i>| is a given difference <i>d</i>.  The following is a list of the first few triples for which <i>d</i> = 1.  (The first twenty-five of these triples are <a href=tripleslist-long.html><font color=3366ff>listed</font></a>.)

<p><center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i><td><i>x</i> &#150; <i>y</i>
<tr align=right><td>3<td>4<td>5<td>1<td>1<td>&#150;1
<tr align=right><td>21<td>20<td>29<td>2<td>3<td>1
<tr align=right><td>119<td>120<td>169<td>5<td>7<td>&#150;1
<tr align=right><td>697<td>696<td>985<td>12<td>17<td>1
<tr align=right><td>4059<td>4060<td>5741<td>29<td>41<td>&#150;1
</table></center>

<p>To find the general form of these triples we must resort to a new technique, for the equation <i>x</i><sup>2</sup> + (<i>x</i> + <i>d</i>)<sup>2</sup> = <i>z</i><sup>2</sup> does not lead to a natural assignment of an index to one of the generators.  But since <i>r</i> and <i>s</i> display simple patterns in fixed-<i>a</i> and -<i>b</i> triples, we might suspect that they will for fixed-<i>d</i> triples also.  We notice two (among many) recurrence relations that seem to hold:  <i>r</i><sub><i>n</i></sub> = <i>r</i><sub><i>n</i> &#150; 1</sub> + <i>s</i><sub><i>n</i> &#150; 1</sub> and <i>s</i><sub><i>n</i></sub> = <i>r</i><sub><i>n</i></sub> + <i>r</i><sub><i>n</i> &#150; 1</sub>.  Substituting for <i>s</i><sub><i>n</i> &#150; 1</sub> we find

<p><center><img src=images/pt39.gif width=137 height=26></center>

<p>Second-order recurrence relations have solutions of the form <i>r</i><sub><i>n</i></sub> = <i>k</i><sup><i>n</i></sup>.  Thus, from the recurrence relation,

<p><center><img src=images/pt40.gif width=139 height=26></center>

<p>the nonzero solutions of which satisfy <i>k</i><sup>2</sup> &#150; 2<i>k</i> &#150; 1 = 0.  So we have

<p><center><img src=images/pt41.gif width=90 height=26></center>

<p>Both of these values for <i>k</i> satisfy the recurrence, but we want the first and second terms to be 1 and 2 (the <i>r</i> values of the first two triples).  Since a linear combination of the two values for <i>k</i> also satisfies the recurrence, we construct the general solution for <i>r</i><sub><i>n</i></sub>,

<p><center><img src=images/pt42.gif width=238 height=28></center>

<p>and solve for the constants we introduce by specifying the first two terms:

<p><center><img src=images/pt43.gif width=267 height=53></center>

<p>We find that

<p><center><img src=images/pt44.gif width=175 height=47></center>

<p>Then

<p><center><img src=images/pt45.gif width=208 height=51></center>

<p>and by the recurrence relations,

<p><center><img src=images/pt46.gif width=291 height=48></center>

<p>So the <i>n</i>th triple satisfying |<i>x</i> &#150; <i>y</i>| = 1 is given (from <a href=#equation3>(3)</a>) by

<p><a id=equation12></a><table width=100%><tr><td><center><img src=images/pt47.gif width=415 height=132></center><td width=10 align=right>(12)</table>

<p>Clearly the difference of <i>x</i><sub><i>n</i></sub> and <i>y</i><sub><i>n</i></sub> is always 1.  Intuitively, we know that as <i>n</i> gets large, the triples (<i>x</i><sub><i>n</i></sub>, <i>y</i><sub><i>n</i></sub>, <i>z</i><sub><i>n</i></sub>) approach the side lengths of a right isosceles triangle, the ratios <i>z</i><sub><i>n</i></sub> / <i>x</i><sub><i>n</i></sub> and <i>z</i><sub><i>n</i></sub> / <i>y</i><sub><i>n</i></sub> approaching &#8730;2.  It is interesting, however, to examine the ratio <a href=http://www.research.att.com/cgi-bin/access.cgi/as/njas/sequences/eisA.cgi?Anum=001333><font color=772266><i>s</i><sub><i>n</i></sub></font></a> / <a href=http://www.research.att.com/cgi-bin/access.cgi/as/njas/sequences/eisA.cgi?Anum=000129><font color=772266><i>r</i><sub><i>n</i></sub></font></a> as <i>n</i> gets large; one finds that not only does this ratio also approach &#8730;2, but <i>s</i><sub><i>n</i></sub> / <i>r</i><sub><i>n</i></sub> is the <i>n</i>th continued fraction convergent to &#8730;2.  This connection becomes apparent when we approach the solution of |<i>x</i> &#150; <i>y</i>| = 1 triples another way and obtain a <a href=http://mathworld.wolfram.com/PellEquation.html><font color=772266>Pell equation</font></a>, the solutions of which are these convergents:

<p><center><img src=images/pt48.gif width=338 height=31></center>

<p>or

<p><center><img src=images/pt49.gif width=108 height=25></center>

<p>Because the sequence <i>s</i><sub><i>n</i></sub> / <i>r</i><sub><i>n</i></sub> are the continued fraction convergents to &#8730;2, <i>r</i><sub><i>n</i></sub> and <i>s</i><sub><i>n</i></sub> are relatively prime.  Moreover, <i>s</i> is odd, and so <i>r</i> and <i>s</i> generate a primitive triple.

<p><br>When <i>d</i> &#8800; 1, the situation is slightly more complicated.  Take <i>d</i> = 7 for example.  The first few triples are:

<p><center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i><td><i>x</i> &#150; <i>y</i>
<tr align=right><td>5<td>12<td>13<td>2<td>1<td>&#150;7
<tr align=right><td>15<td>8<td>17<td>1<td>3<td>7
<tr align=right><td>55<td>48<td>73<td>3<td>5<td>7
<tr align=right><td>65<td>72<td>97<td>4<td>5<td>&#150;7
<tr align=right><td>297<td>304<td>425<td>8<td>11<td>&#150;7
<tr align=right><td>403<td>396<td>565<td>9<td>13<td>7
<tr align=right><td>1755<td>1748<td>2477<td>19<td>27<td>7
<tr align=right><td>2325<td>2332<td>3293<td>22<td>31<td>&#150;7
<tr align=right><td>10205<td>10212<td>14437<td>46<td>65<td>&#150;7
<tr align=right><td>13575<td>13568<td>19193<td>53<td>75<td>7
</table></center>

<p>At first glance it appears that these <i>r</i> and <i>s</i> values hardly form nice recurrence relations.  But in fact they do; there are <i>two</i> "threads" of the same relation (with different initial values) running through these triples, more easily seen when they are sorted:

<p><center><table cellpadding=3>
<tr align=center><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i><td><i>x</i> &#150; <i>y</i><td rowspan=6><img src=images/whitespace-horizontal.gif width=48 height=1><td><i>x</i><td><i>y</i><td><i>z</i><td><i>r</i><td><i>s</i><td><i>x</i> &#150; <i>y</i>
<tr align=right><td>5<td>12<td>13<td>2<td>1<td>&#150;7<td>15<td>8<td>17<td>1<td>3<td>7
<tr align=right><td>55<td>48<td>73<td>3<td>5<td>7<td>65<td>72<td>97<td>4<td>5<td>&#150;7
<tr align=right><td>297<td>304<td>425<td>8<td>11<td>&#150;7<td>403<td>396<td>565<td>9<td>13<td>7
<tr align=right><td>1755<td>1748<td>2477<td>19<td>27<td>7<td>2325<td>2332<td>3293<td>22<td>31<td>&#150;7
<tr align=right><td>10205<td>10212<td>14437<td>46<td>65<td>&#150;7<td>13575<td>13568<td>19193<td>53<td>75<td>7
</table></center>

<p>Again the recurrence is

<p><center><img src=images/pt39.gif width=137 height=26></center>

<p>Therefore, as above, the general solution is

<p><a id=equation13></a><table width=100%><tr><td><center><img src=images/pt50.gif width=593 height=46></center><td width=10 align=right>(13)</table>

<p>So the first thread of triples for which |<i>x</i> &#150; <i>y</i>| = 7 is given by

<p><center><img src=images/pt51.gif width=457 height=216></center>

<p>and the second thread is given by

<p><center><img src=images/pt52.gif width=430 height=211></center>

<p>In general, <i>x</i> &#150; <i>y</i> = <i>s</i><sup>2</sup> &#150; 2<i>r</i><sup>2</sup>, and the only numbers of this form, for <i>r</i> and <i>s</i> relatively prime and <i>s</i> odd, are those whose prime factors all satisfy <i>p</i> &#8801; &#177;1 mod 8.  These primes comprise the sequence 7, 17, 23, 31, 41, 47, 71, 73, 79, 89, 97,...&nbsp;  As representations as a sum of two squares were counted by factoring over <b>Z</b>[<i>i</i>] in <a href=#sectionIII>Section III</a>, we can count "fundamental" representations of a given number as <i>s</i><sup>2</sup> &#150; 2<i>r</i><sup>2</sup> = (<i>s</i> + <i>r</i>&#8730;2) (<i>s</i> &#150; <i>r</i>&#8730;2) by factoring over <b>Z</b>[&#8730;2].  For example, &#150;1 = 1<sup>2</sup> &#150; 2 &#183; 1<sup>2</sup>.  The ring <b>Z</b>[&#8730;2] has infinitely many units, given by &#177;(1 + &#8730;2)<sup><i>n</i></sup> for integers <i>n</i>.  Call a representation <i>s</i><sup>2</sup> &#150; 2<i>r</i><sup>2</sup> <i>fundamental</i> if <i>s</i> &#8804; <i>r</i> or <i>s</i> &#8805; 2<i>r</i>.  Each fundamental representation <i>s</i><sub>1</sub><sup>2</sup> &#150; 2<i>r</i><sub>1</sub><sup>2</sup> gives rise to a thread of triples generated by <i>s</i><sub><i>n</i></sub> + <i>r</i><sub><i>n</i></sub>&#8730;2 = (<i>s</i><sub>1</sub> + <i>r</i><sub>1</sub>&#8730;2) (1 + &#8730;2)<sup><i>n</i></sup> for nonnegative integers <i>n</i>.  Each prime factor contributes two fundamental solutions, so we have the following result.

<p><a id=proposition2></a><b>Proposition 2</b> &nbsp;<i>Let d be a natural number whose prime factors all satisfy p</i> &#8801; &#177;1 mod 8<i>.  Then the number of fundamental representations of d in the form <i>s</i><sup>2</sup> &#150; 2<i>r</i><sup>2</sup> for positive integers <i>r</i> and <i>s</i> is </i>2<sup><i>&omega;</i>(<i>d</i>)</sup><i>, where &omega;</i>(<i>d</i>)<i> is the number of distinct prime factors of d.</i>

<p>(Alternatively, we could have considered sequences of triples that are infinitely long in both the positive and negative directions.  In this case, there are 2<sup><i>&omega;</i>(<i>d</i>) &#150; 1</sup> (double-sided) threads for a given <i>d</i>, and the case <i>d</i> = 1  must be separated from the others (since it still has only one thread, which is redundant).  In this setup, however, we obtain triples with negative legs.)

<p>Each fundamental solution (<i>r</i><sub>1</sub>, <i>s</i><sub>1</sub>) gives rise to the sequence of triples

<p><center><img src=images/pt53.gif width=617 height=360></center>

<p>For example, let <i>d</i> = 2737 = 7 &#183; 17 &#183; 23.  The fundamental representations for these prime factors are

<p><center><img src=images/pt54.gif width=534 height=50></center>

<p>Thus 2737 has the following fundamental representations (where we divide each product by a power of 1 + &#8730;2 to obtain fundamental representations, in this case the first power):

<p><center><img src=images/pt55.gif width=470 height=185></center>

<p>An additional four threads come from the fundamental representations of &#150;2737:

<p><center><img src=images/pt56.gif width=493 height=188></center>


</table><table width=100% cellspacing=10><tr><td>
<p><br><a id=references></a><center><b><font size=5>References</font></b></center>

<p>Relevant links:<ul>
<li><a href=http://mathworld.wolfram.com/PythagoreanTriple.html><font color=772266>Pythagorean Triple</font></a> on MathWorld
<li><a href=http://mathworld.wolfram.com/RightTriangle.html><font color=772266>Right Triangle</font></a> on MathWorld
<li><a href=http://www.pbs.org/wgbh/nova/proof><font color=772266>NOVA:  The Proof:</font></a> NOVA's documentary about Andrew Wiles's proof of Fermat's Last Theorem
<li><a href=http://www.uwgb.edu/dutchs/recmath/rmpowers.htm><font color=772266>Power Page:</font></a> accurately subtitled "Interesting Stuff About Powers of Numbers"
<li><a href=http://www.friesian.com/pythag.htm><font color=772266>Pythagorean Triplets:</font></a> all about triples that satisfy <i>z</i> &#150; <i>y</i> = 1
</ul>

<!-- Start of StatCounter Code -->
<script type="text/javascript" language="javascript">
var sc_project=371526;
var sc_partition=1;
</script>
<script type="text/javascript" language="javascript" src="http://www.statcounter.com/counter/counter.js"></script><noscript><a href="http://www.statcounter.com/free_web_stats.html" target="_blank"><img src="http://c2.statcounter.com/counter.php?sc_project=371526&amp;java=0" width=0 height=0 border="0"></a></noscript>
<!-- End of StatCounter Code -->

<script language=javascript>footer();</script></body></html>